if(typeof module==="object"){ICAL=module.exports}else{if(typeof ICAL!=="object"){this.ICAL={}}}ICAL.foldLength=75;ICAL.newLineChar="\r\n";ICAL.helpers={updateTimezones:function(f){var e,c,a,d,b,g;if(!f||f.name!=="vcalendar"){return f}e=f.getAllSubcomponents();c=[];a={};for(b=0;b<e.length;b++){if(e[b].name==="vtimezone"){g=e[b].getFirstProperty("tzid").getFirstValue();a[g]=e[b]}else{c=c.concat(e[b].getAllProperties())}}d={};for(b=0;b<c.length;b++){if((g=c[b].getParameter("tzid"))){d[g]=true}}for(b in a){if(a.hasOwnProperty(b)&&!d[b]){f.removeSubcomponent(a[b])}}for(b in d){if(d.hasOwnProperty(b)&&!a[b]&&ICAL.TimezoneService.has(b)){f.addSubcomponent(ICAL.TimezoneService.get(b).component)}}return f},isStrictlyNaN:function(a){return typeof(a)==="number"&&isNaN(a)},strictParseInt:function(b){var a=parseInt(b,10);if(ICAL.helpers.isStrictlyNaN(a)){throw new Error('Could not extract integer from "'+b+'"')}return a},formatClassType:function formatClassType(b,a){if(typeof(b)==="undefined"){return undefined}if(b instanceof a){return b}return new a(b)},unescapedIndexOf:function(a,b,c){while((c=a.indexOf(b,c))!==-1){if(c>0&&a[c-1]==="\\"){c+=1}else{return c}}return -1},binsearchInsert:function(e,f,c){if(!e.length){return 0}var a=0,d=e.length-1,b,g;while(a<=d){b=a+Math.floor((d-a)/2);g=c(f,e[b]);if(g<0){d=b-1}else{if(g>0){a=b+1}else{break}}}if(g<0){return b}else{if(g>0){return b+1}else{return b}}},dumpn:function(){if(!ICAL.debug){return}if(typeof(console)!=="undefined"&&"log" in console){ICAL.helpers.dumpn=function b(c){console.log(c)}}else{ICAL.helpers.dumpn=function a(c){dump(c+"\n")}}ICAL.helpers.dumpn(arguments[0])},clone:function(b,f){if(!b||typeof b!="object"){return b}else{if(b instanceof Date){return new Date(b.getTime())}else{if("clone" in b){return b.clone()}else{if(Array.isArray(b)){var a=[];for(var d=0;d<b.length;d++){a.push(f?ICAL.helpers.clone(b[d],true):b[d])}return a}else{var e={};for(var c in b){if(Object.prototype.hasOwnProperty.call(b,c)){if(f){e[c]=ICAL.helpers.clone(b[c],true)}else{e[c]=b[c]}}}return e}}}}},foldline:function foldline(c){var a="";var b=c||"";while(b.length){a+=ICAL.newLineChar+" "+b.substr(0,ICAL.foldLength);b=b.substr(ICAL.foldLength)}return a.substr(ICAL.newLineChar.length+1)},pad2:function pad(b){if(typeof(b)!=="string"){if(typeof(b)==="number"){b=parseInt(b)}b=String(b)}var a=b.length;switch(a){case 0:return"00";case 1:return"0"+b;default:return b}},trunc:function trunc(a){return(a<0?Math.ceil(a):Math.floor(a))},inherits:function(c,d,a){function b(){}b.prototype=c.prototype;d.prototype=new b();if(a){ICAL.helpers.extend(a,d.prototype)}},extend:function(b,d){for(var a in b){var c=Object.getOwnPropertyDescriptor(b,a);if(c&&!Object.getOwnPropertyDescriptor(d,a)){Object.defineProperty(d,a,c)}}return d}};ICAL.design=(function(){var y=/\\\\|\\;|\\,|\\[Nn]/g;var x=/\\|;|,|\n/g;var E=/\\\\|\\,|\\[Nn]/g;var f=/\\|,|\n/g;function B(J,I){var H={matches:/.*/,fromICAL:function(K,L){return t(K,J,L)},toICAL:function(K,L){var M=I;if(L){M=new RegExp(M.source+"|"+L)}return K.replace(M,function(N){switch(N){case"\\":return"\\\\";case";":return"\\;";case",":return"\\,";case"\n":return"\\n";default:return N}})}};return H}var z={defaultType:"text"};var D={defaultType:"text",multiValue:","};var j={defaultType:"text",structuredValue:";"};var l={defaultType:"integer"};var g={defaultType:"date-time",allowedTypes:["date-time","date"]};var d={defaultType:"date-time"};var s={defaultType:"uri"};var k={defaultType:"utc-offset"};var m={defaultType:"recur"};var v={defaultType:"date-and-or-time",allowedTypes:["date-time","date","text"]};function o(H){switch(H){case"\\\\":return"\\";case"\\;":return";";case"\\,":return",";case"\\n":case"\\N":return"\n";default:return H}}function t(J,H,I){if(J.indexOf("\\")===-1){return J}if(I){H=new RegExp(H.source+"|\\\\"+I)}return J.replace(H,o)}var i={categories:D,url:s,version:z,uid:z};var h={"boolean":{values:["TRUE","FALSE"],fromICAL:function(H){switch(H){case"TRUE":return true;case"FALSE":return false;default:return false}},toICAL:function(H){if(H){return"TRUE"}return"FALSE"}},"float":{matches:/^[+-]?\d+\.\d+$/,fromICAL:function(I){var H=parseFloat(I);if(ICAL.helpers.isStrictlyNaN(H)){return 0}return H},toICAL:function(H){return String(H)}},integer:{fromICAL:function(I){var H=parseInt(I);if(ICAL.helpers.isStrictlyNaN(H)){return 0}return H},toICAL:function(H){return String(H)}},"utc-offset":{toICAL:function(H){if(H.length<7){return H.substr(0,3)+H.substr(4,2)}else{return H.substr(0,3)+H.substr(4,2)+H.substr(7,2)}},fromICAL:function(H){if(H.length<6){return H.substr(0,3)+":"+H.substr(3,2)}else{return H.substr(0,3)+":"+H.substr(3,2)+":"+H.substr(5,2)}},decorate:function(H){return ICAL.UtcOffset.fromString(H)},undecorate:function(H){return H.toString()}}};var F={cutype:{values:["INDIVIDUAL","GROUP","RESOURCE","ROOM","UNKNOWN"],allowXName:true,allowIanaToken:true},"delegated-from":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:true},"delegated-to":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:true},encoding:{values:["8BIT","BASE64"]},fbtype:{values:["FREE","BUSY","BUSY-UNAVAILABLE","BUSY-TENTATIVE"],allowXName:true,allowIanaToken:true},member:{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:true},partstat:{values:["NEEDS-ACTION","ACCEPTED","DECLINED","TENTATIVE","DELEGATED","COMPLETED","IN-PROCESS"],allowXName:true,allowIanaToken:true},range:{values:["THISLANDFUTURE"]},related:{values:["START","END"]},reltype:{values:["PARENT","CHILD","SIBLING"],allowXName:true,allowIanaToken:true},role:{values:["REQ-PARTICIPANT","CHAIR","OPT-PARTICIPANT","NON-PARTICIPANT"],allowXName:true,allowIanaToken:true},rsvp:{values:["TRUE","FALSE"]},"sent-by":{valueType:"cal-address"},tzid:{matches:/^\//},value:{values:["binary","boolean","cal-address","date","date-time","duration","float","integer","period","recur","text","time","uri","utc-offset"],allowXName:true,allowIanaToken:true}};var c=ICAL.helpers.extend(h,{text:B(y,x),uri:{},binary:{decorate:function(H){return ICAL.Binary.fromString(H)},undecorate:function(H){return H.toString()}},"cal-address":{},date:{decorate:function(I,H){return ICAL.Time.fromDateString(I,H)},undecorate:function(H){return H.toString()},fromICAL:function(H){return H.substr(0,4)+"-"+H.substr(4,2)+"-"+H.substr(6,2)},toICAL:function(H){if(H.length>11){return H}return H.substr(0,4)+H.substr(5,2)+H.substr(8,2)}},"date-time":{fromICAL:function(I){var H=I.substr(0,4)+"-"+I.substr(4,2)+"-"+I.substr(6,2)+"T"+I.substr(9,2)+":"+I.substr(11,2)+":"+I.substr(13,2);if(I[15]&&I[15]==="Z"){H+="Z"}return H},toICAL:function(I){if(I.length<19){return I}var H=I.substr(0,4)+I.substr(5,2)+I.substr(8,5)+I.substr(14,2)+I.substr(17,2);if(I[19]&&I[19]==="Z"){H+="Z"}return H},decorate:function(I,H){return ICAL.Time.fromDateTimeString(I,H)},undecorate:function(H){return H.toString()}},duration:{decorate:function(H){return ICAL.Duration.fromString(H)},undecorate:function(H){return H.toString()}},period:{fromICAL:function(H){var I=H.split("/");I[0]=c["date-time"].fromICAL(I[0]);if(!ICAL.Duration.isValueString(I[1])){I[1]=c["date-time"].fromICAL(I[1])}return I},toICAL:function(H){H[0]=c["date-time"].toICAL(H[0]);if(!ICAL.Duration.isValueString(H[1])){H[1]=c["date-time"].toICAL(H[1])}return H.join("/")},decorate:function(I,H){return ICAL.Period.fromJSON(I,H)},undecorate:function(H){return H.toJSON()}},recur:{fromICAL:function(H){return ICAL.Recur._stringToData(H,true)},toICAL:function(I){var K="";for(var H in I){if(!Object.prototype.hasOwnProperty.call(I,H)){continue}var J=I[H];if(H=="until"){if(J.length>10){J=c["date-time"].toICAL(J)}else{J=c.date.toICAL(J)}}else{if(H=="wkst"){if(typeof J==="number"){J=ICAL.Recur.numericDayToIcalDay(J)}}else{if(Array.isArray(J)){J=J.join(",")}}}K+=H.toUpperCase()+"="+J+";"}return K.substr(0,K.length-1)},decorate:function r(H){return ICAL.Recur.fromData(H)},undecorate:function(H){return H.toJSON()}},time:{fromICAL:function(I){if(I.length<6){return I}var H=I.substr(0,2)+":"+I.substr(2,2)+":"+I.substr(4,2);if(I[6]==="Z"){H+="Z"}return H},toICAL:function(I){if(I.length<8){return I}var H=I.substr(0,2)+I.substr(3,2)+I.substr(6,2);if(I[8]==="Z"){H+="Z"}return H}}});var q=ICAL.helpers.extend(i,{action:z,attach:{defaultType:"uri"},attendee:{defaultType:"cal-address"},calscale:z,"class":z,comment:z,completed:d,contact:z,created:d,description:z,dtend:g,dtstamp:d,dtstart:g,due:g,duration:{defaultType:"duration"},exdate:{defaultType:"date-time",allowedTypes:["date-time","date"],multiValue:","},exrule:m,freebusy:{defaultType:"period",multiValue:","},geo:{defaultType:"float",structuredValue:";"},"last-modified":d,location:z,method:z,organizer:{defaultType:"cal-address"},"percent-complete":l,priority:l,prodid:z,"related-to":z,repeat:l,rdate:{defaultType:"date-time",allowedTypes:["date-time","date","period"],multiValue:",",detectType:function(H){if(H.indexOf("/")!==-1){return"period"}return(H.indexOf("T")===-1)?"date":"date-time"}},"recurrence-id":g,resources:D,"request-status":j,rrule:m,sequence:l,status:z,summary:z,transp:z,trigger:{defaultType:"duration",allowedTypes:["duration","date-time"]},tzoffsetfrom:k,tzoffsetto:k,tzurl:s,tzid:z,tzname:z});var A=ICAL.helpers.extend(h,{text:B(E,f),uri:B(E,f),date:{decorate:function(H){return ICAL.VCardTime.fromDateAndOrTimeString(H,"date")},undecorate:function(H){return H.toString()},fromICAL:function(H){if(H.length==8){return c.date.fromICAL(H)}else{if(H[0]=="-"&&H.length==6){return H.substr(0,4)+"-"+H.substr(4)}else{return H}}},toICAL:function(H){if(H.length==10){return c.date.toICAL(H)}else{if(H[0]=="-"&&H.length==7){return H.substr(0,4)+H.substr(5)}else{return H}}}},time:{decorate:function(H){return ICAL.VCardTime.fromDateAndOrTimeString("T"+H,"time")},undecorate:function(H){return H.toString()},fromICAL:function(I){var K=A.time._splitZone(I,true);var H=K[0],J=K[1];if(J.length==6){J=J.substr(0,2)+":"+J.substr(2,2)+":"+J.substr(4,2)}else{if(J.length==4&&J[0]!="-"){J=J.substr(0,2)+":"+J.substr(2,2)}else{if(J.length==5){J=J.substr(0,3)+":"+J.substr(3,2)}}}if(H.length==5&&(H[0]=="-"||H[0]=="+")){H=H.substr(0,3)+":"+H.substr(3)}return J+H},toICAL:function(I){var K=A.time._splitZone(I);var H=K[0],J=K[1];if(J.length==8){J=J.substr(0,2)+J.substr(3,2)+J.substr(6,2)}else{if(J.length==5&&J[0]!="-"){J=J.substr(0,2)+J.substr(3,2)}else{if(J.length==6){J=J.substr(0,3)+J.substr(4,2)}}}if(H.length==6&&(H[0]=="-"||H[0]=="+")){H=H.substr(0,3)+H.substr(4)}return J+H},_splitZone:function(M,I){var L=M.length-1;var H=M.length-(I?5:6);var K=M[H];var J,N;if(M[L]=="Z"){J=M[L];N=M.substr(0,L)}else{if(M.length>6&&(K=="-"||K=="+")){J=M.substr(H);N=M.substr(0,H)}else{J="";N=M}}return[J,N]}},"date-time":{decorate:function(H){return ICAL.VCardTime.fromDateAndOrTimeString(H,"date-time")},undecorate:function(H){return H.toString()},fromICAL:function(H){return A["date-and-or-time"].fromICAL(H)},toICAL:function(H){return A["date-and-or-time"].toICAL(H)}},"date-and-or-time":{decorate:function(H){return ICAL.VCardTime.fromDateAndOrTimeString(H,"date-and-or-time")},undecorate:function(H){return H.toString()},fromICAL:function(H){var I=H.split("T");return(I[0]?A.date.fromICAL(I[0]):"")+(I[1]?"T"+A.time.fromICAL(I[1]):"")},toICAL:function(H){var I=H.split("T");return A.date.toICAL(I[0])+(I[1]?"T"+A.time.toICAL(I[1]):"")}},timestamp:c["date-time"],"language-tag":{matches:/^[a-zA-Z0-9-]+$/}});var u={type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","time","date-time","date-and-or-time","timestamp","boolean","integer","float","utc-offset","language-tag"],allowXName:true,allowIanaToken:true}};var n=ICAL.helpers.extend(i,{adr:{defaultType:"text",structuredValue:";",multiValue:","},anniversary:v,bday:v,caladruri:s,caluri:s,clientpidmap:j,email:z,fburl:s,fn:z,gender:j,geo:s,impp:s,key:s,kind:z,lang:{defaultType:"language-tag"},logo:s,member:s,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:D,note:z,org:{defaultType:"text",structuredValue:";"},photo:s,related:s,rev:{defaultType:"timestamp"},role:z,sound:s,source:s,tel:{defaultType:"uri",allowedTypes:["uri","text"]},title:z,tz:{defaultType:"text",allowedTypes:["text","utc-offset","uri"]},xml:z});var a=ICAL.helpers.extend(h,{binary:c.binary,date:A.date,"date-time":A["date-time"],"phone-number":{},uri:c.uri,text:c.text,time:c.time,vcard:c.text,"utc-offset":{toICAL:function(H){return H.substr(0,7)},fromICAL:function(H){return H.substr(0,7)},decorate:function(H){return ICAL.UtcOffset.fromString(H)},undecorate:function(H){return H.toString()}}});var C={type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","date-time","phone-number","time","boolean","integer","float","utc-offset","vcard","binary"],allowXName:true,allowIanaToken:true}};var e=ICAL.helpers.extend(i,{fn:z,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:D,photo:{defaultType:"binary",allowedTypes:["binary","uri"]},bday:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(H){return(H.indexOf("T")===-1)?"date":"date-time"}},adr:{defaultType:"text",structuredValue:";",multiValue:","},label:z,tel:{defaultType:"phone-number"},email:z,mailer:z,tz:{defaultType:"utc-offset",allowedTypes:["utc-offset","text"]},geo:{defaultType:"float",structuredValue:";"},title:z,role:z,logo:{defaultType:"binary",allowedTypes:["binary","uri"]},agent:{defaultType:"vcard",allowedTypes:["vcard","text","uri"]},org:j,note:D,prodid:z,rev:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(H){return(H.indexOf("T")===-1)?"date":"date-time"}},"sort-string":z,sound:{defaultType:"binary",allowedTypes:["binary","uri"]},"class":z,key:{defaultType:"binary",allowedTypes:["binary","text"]}});var w={value:c,param:F,property:q};var G={value:A,param:u,property:n};var b={value:a,param:C,property:e};var p={defaultSet:w,defaultType:"unknown",components:{vcard:G,vcard3:b,vevent:w,vtodo:w,vjournal:w,valarm:w,vtimezone:w,daylight:w,standard:w},icalendar:w,vcard:G,vcard3:b,getDesignSet:function(H){var I=H&&H in p.components;return I?p.components[H]:p.defaultSet}};return p}());ICAL.stringify=(function(){var e="\r\n";var c="unknown";var b=ICAL.design;var d=ICAL.helpers;function f(k){if(typeof k[0]=="string"){k=[k]}var j=0;var h=k.length;var g="";for(;j<h;j++){g+=f.component(k[j])+e}return g}f.component=function(m,o){var g=m[0].toUpperCase();var q="BEGIN:"+g+e;var l=m[1];var j=0;var i=l.length;var n=m[0];if(n==="vcard"&&m[1].length>0&&!(m[1][0][0]==="version"&&m[1][0][3]==="4.0")){n="vcard3"}o=o||b.getDesignSet(n);for(;j<i;j++){q+=f.property(l[j],o)+e}var h=m[2]||[];var p=0;var k=h.length;for(;p<k;p++){q+=f.component(h[p],o)+e}q+="END:"+g;return q};f.property=function(q,r,g){var i=q[0].toUpperCase();var s=q[0];var l=q[1];var t=i;var m;for(m in l){var p=l[m];if(l.hasOwnProperty(m)){var o=(m in r.param)&&r.param[m].multiValue;if(o&&Array.isArray(p)){if(r.param[m].multiValueSeparateDQuote){o='"'+o+'"'}p=p.map(f._rfc6868Unescape);p=f.multiValue(p,o,"unknown",null,r)}else{p=f._rfc6868Unescape(p)}t+=";"+m.toUpperCase();t+="="+f.propertyValue(p)}}if(q.length===3){return t+":"}var k=q[2];if(!r){r=b.defaultSet}var h;var o=false;var n=false;var j=false;if(s in r.property){h=r.property[s];if("multiValue" in h){o=h.multiValue}if(("structuredValue" in h)&&Array.isArray(q[3])){n=h.structuredValue}if("defaultType" in h){if(k===h.defaultType){j=true}}else{if(k===c){j=true}}}else{if(k===c){j=true}}if(!j){t+=";VALUE="+k.toUpperCase()}t+=":";if(o&&n){t+=f.multiValue(q[3],n,k,o,r,n)}else{if(o){t+=f.multiValue(q.slice(3),o,k,null,r,false)}else{if(n){t+=f.multiValue(q[3],n,k,null,r,n)}else{t+=f.value(q[3],k,r,false)}}}return g?t:ICAL.helpers.foldline(t)};f.propertyValue=function(g){if((d.unescapedIndexOf(g,",")===-1)&&(d.unescapedIndexOf(g,":")===-1)&&(d.unescapedIndexOf(g,";")===-1)){return g}return'"'+g+'"'};f.multiValue=function(n,h,m,g,o,l){var p="";var k=n.length;var j=0;for(;j<k;j++){if(g&&Array.isArray(n[j])){p+=f.multiValue(n[j],g,m,null,o,l)}else{p+=f.value(n[j],m,o,l)}if(j!==(k-1)){p+=h}}return p};f.value=function(j,h,g,i){if(h in g.value&&"toICAL" in g.value[h]){return g.value[h].toICAL(j,i)}return j};f._rfc6868Unescape=function(g){return g.replace(/[\n^"]/g,function(h){return a[h]})};var a={'"':"^'","\n":"^n","^":"^^"};return f}());ICAL.parse=(function(){var k=/[^ \t]/;var j=",";var l=":";var h=";";var g="=";var e="unknown";var d="text";var f=ICAL.design;var c=ICAL.helpers;function i(n){this.message=n;this.name="ParserError";try{throw new Error()}catch(o){if(o.stack){var m=o.stack.split("\n");m.shift();this.stack=m.join("\n")}}}i.prototype=Error.prototype;function b(n){var o={};var m=o.component=[];o.stack=[m];b._eachLine(n,function(q,p){b._handleContentLine(p,o)});if(o.stack.length>1){throw new i("invalid ical body. component began but did not end")}o=null;return(m.length==1?m[0]:m)}b.property=function(o,m){var n={component:[[],[]],designSet:m||f.defaultSet};b._handleContentLine(o,n);return n.component[1][0]};b.component=function(m){return b(m)};b.ParserError=i;b._handleContentLine=function(B,o){var y=B.indexOf(l);var t=B.indexOf(h);var n;var q;var p;var x;var s={};if((t!==-1&&y!==-1)){if(t>y){t=-1}}var z;if(t!==-1){p=B.substring(0,t).toLowerCase();z=b._parseParameters(B.substring(t),0,o.designSet);if(z[2]==-1){throw new i("Invalid parameters in '"+B+"'")}s=z[0];n=z[1].length+z[2]+t;if((q=B.substring(n).indexOf(l))!==-1){x=B.substring(n+q+1)}else{throw new i("Missing parameter value in '"+B+"'")}}else{if(y!==-1){p=B.substring(0,y).toLowerCase();x=B.substring(y+1);if(p==="begin"){var v=[x.toLowerCase(),[],[]];if(o.stack.length===1){o.component.push(v)}else{o.component[2].push(v)}o.stack.push(o.component);o.component=v;if(!o.designSet){o.designSet=f.getDesignSet(o.component[0])}return}else{if(p==="end"){o.component=o.stack.pop();return}}}else{throw new i('invalid line (no token ";" or ":") "'+B+'"')}}var r;var w=false;var u=false;var m;if(p in o.designSet.property){m=o.designSet.property[p];if("multiValue" in m){w=m.multiValue}if("structuredValue" in m){u=m.structuredValue}if(x&&"detectType" in m){r=m.detectType(x)}}if(!r){if(!("value" in s)){if(m){r=m.defaultType}else{r=e}}else{r=s.value.toLowerCase()}}delete s.value;var A;if(w&&u){x=b._parseMultiValue(x,u,r,[],w,o.designSet,u);A=[p,s,r,x]}else{if(w){A=[p,s,r];b._parseMultiValue(x,w,r,A,null,o.designSet,false)}else{if(u){x=b._parseMultiValue(x,u,r,[],null,o.designSet,u);A=[p,s,r,x]}else{x=b._parseValue(x,r,o.designSet,false);A=[p,s,r,x]}}}if(o.component[0]==="vcard"&&o.component[1].length===0&&!(p==="version"&&x==="4.0")){o.designSet=f.getDesignSet("vcard3")}o.component[1].push(A)};b._parseValue=function(p,n,m,o){if(n in m.value&&"fromICAL" in m.value[n]){return m.value[n].fromICAL(p,o)}return p};b._parseParameters=function(u,p,z){var A=p;var q=0;var C=g;var t={};var E,r;var w,y=-1;var o,n,B;while((q!==false)&&(q=c.unescapedIndexOf(u,C,q+1))!==-1){E=u.substr(A+1,q-A-1);if(E.length==0){throw new i("Empty parameter name in '"+u+"'")}r=E.toLowerCase();if(r in z.param&&z.param[r].valueType){o=z.param[r].valueType}else{o=d}if(r in z.param){n=z.param[r].multiValue;if(z.param[r].multiValueSeparateDQuote){B=b._rfc6868Escape('"'+n+'"')}}var s=u[q+1];if(s==='"'){y=q+2;q=c.unescapedIndexOf(u,'"',y);if(n&&q!=-1){var v=true;while(v){if(u[q+1]==n&&u[q+2]=='"'){q=c.unescapedIndexOf(u,'"',q+3)}else{v=false}}}if(q===-1){throw new i('invalid line (no matching double quote) "'+u+'"')}w=u.substr(y,q-y);A=c.unescapedIndexOf(u,h,q);if(A===-1){q=false}}else{y=q+1;var x=c.unescapedIndexOf(u,h,y);var m=c.unescapedIndexOf(u,l,y);if(m!==-1&&x>m){x=m;q=false}else{if(x===-1){if(m===-1){x=u.length}else{x=m}q=false}else{A=x;q=x}}w=u.substr(y,x-y)}w=b._rfc6868Escape(w);if(n){var D=B||n;t[r]=b._parseMultiValue(w,D,o,[],null,z)}else{t[r]=b._parseValue(w,o,z)}}return[t,w,y]};b._rfc6868Escape=function(m){return m.replace(/\^['n^]/g,function(n){return a[n]})};var a={"^'":'"',"^n":"\n","^^":"^"};b._parseMultiValue=function(o,n,q,v,m,u,p){var s=0;var r=0;var t;if(n.length===0){return o}while((s=c.unescapedIndexOf(o,n,r))!==-1){t=o.substr(r,s-r);if(m){t=b._parseMultiValue(t,m,q,[],null,u,p)}else{t=b._parseValue(t,q,u,p)}v.push(t);r=s+n.length}t=o.substr(r);if(m){t=b._parseMultiValue(t,m,q,[],null,u,p)}else{t=b._parseValue(t,q,u,p)}v.push(t);return v.length==1?v[0]:v};b._eachLine=function(o,t){var m=o.length;var r=o.search(k);var s=r;var n;var q;var p;do{s=o.indexOf("\n",r)+1;if(s>1&&o[s-2]==="\r"){p=2}else{p=1}if(s===0){s=m;p=0}q=o[r];if(q===" "||q==="\t"){n+=o.substr(r+1,s-r-(p+1))}else{if(n){t(null,n)}n=o.substr(r,s-r-p)}r=s}while(s!==m);n=n.trim();if(n.length){t(null,n)}};return b}());ICAL.Component=(function(){var b=1;var d=2;var c=0;function a(f,e){if(typeof(f)==="string"){f=[f,[],[]]}this.jCal=f;this.parent=e||null}a.prototype={_hydratedPropertyCount:0,_hydratedComponentCount:0,get name(){return this.jCal[c]},get _designSet(){var e=this.parent&&this.parent._designSet;return e||ICAL.design.getDesignSet(this.name)},_hydrateComponent:function(f){if(!this._components){this._components=[];this._hydratedComponentCount=0}if(this._components[f]){return this._components[f]}var e=new a(this.jCal[d][f],this);this._hydratedComponentCount++;return(this._components[f]=e)},_hydrateProperty:function(e){if(!this._properties){this._properties=[];this._hydratedPropertyCount=0}if(this._properties[e]){return this._properties[e]}var f=new ICAL.Property(this.jCal[b][e],this);this._hydratedPropertyCount++;return(this._properties[e]=f)},getFirstSubcomponent:function(g){if(g){var h=0;var j=this.jCal[d];var f=j.length;for(;h<f;h++){if(j[h][c]===g){var e=this._hydrateComponent(h);return e}}}else{if(this.jCal[d].length){return this._hydrateComponent(0)}}return null},getAllSubcomponents:function(g){var f=this.jCal[d].length;var h=0;if(g){var j=this.jCal[d];var e=[];for(;h<f;h++){if(g===j[h][c]){e.push(this._hydrateComponent(h))}}return e}else{if(!this._components||(this._hydratedComponentCount!==f)){for(;h<f;h++){this._hydrateComponent(h)}}return this._components||[]}},hasProperty:function(f){var h=this.jCal[b];var e=h.length;var g=0;for(;g<e;g++){if(h[g][c]===f){return true}}return false},getFirstProperty:function(g){if(g){var h=0;var j=this.jCal[b];var f=j.length;for(;h<f;h++){if(j[h][c]===g){var e=this._hydrateProperty(h);return e}}}else{if(this.jCal[b].length){return this._hydrateProperty(0)}}return null},getFirstPropertyValue:function(e){var f=this.getFirstProperty(e);if(f){return f.getFirstValue()}return null},getAllProperties:function(g){var f=this.jCal[b].length;var h=0;if(g){var j=this.jCal[b];var e=[];for(;h<f;h++){if(g===j[h][c]){e.push(this._hydrateProperty(h))}}return e}else{if(!this._properties||(this._hydratedPropertyCount!==f)){for(;h<f;h++){this._hydrateProperty(h)}}return this._properties||[]}},_removeObjectByIndex:function(f,e,g){e=e||[];if(e[g]){var h=e[g];if("parent" in h){h.parent=null}}e.splice(g,1);this.jCal[f].splice(g,1)},_removeObject:function(h,g,f){var j=0;var l=this.jCal[h];var e=l.length;var k=this[g];if(typeof(f)==="string"){for(;j<e;j++){if(l[j][c]===f){this._removeObjectByIndex(h,k,j);return true}}}else{if(k){for(;j<e;j++){if(k[j]&&k[j]===f){this._removeObjectByIndex(h,k,j);return true}}}}return false},_removeAllObjects:function(f,e,g){var j=this[e];var k=this.jCal[f];var h=k.length-1;for(;h>=0;h--){if(!g||k[h][c]===g){this._removeObjectByIndex(f,j,h)}}},addSubcomponent:function(f){if(!this._components){this._components=[];this._hydratedComponentCount=0}if(f.parent){f.parent.removeSubcomponent(f)}var e=this.jCal[d].push(f.jCal);this._components[e-1]=f;this._hydratedComponentCount++;f.parent=this;return f},removeSubcomponent:function(e){var f=this._removeObject(d,"_components",e);if(f){this._hydratedComponentCount--}return f},removeAllSubcomponents:function(e){var f=this._removeAllObjects(d,"_components",e);this._hydratedComponentCount=0;return f},addProperty:function(f){if(!(f instanceof ICAL.Property)){throw new TypeError("must instance of ICAL.Property")}if(!this._properties){this._properties=[];this._hydratedPropertyCount=0}if(f.parent){f.parent.removeProperty(f)}var e=this.jCal[b].push(f.jCal);this._properties[e-1]=f;this._hydratedPropertyCount++;f.parent=this;return f},addPropertyWithValue:function(e,f){var g=new ICAL.Property(e);g.setValue(f);this.addProperty(g);return g},updatePropertyWithValue:function(e,f){var g=this.getFirstProperty(e);if(g){g.setValue(f)}else{g=this.addPropertyWithValue(e,f)}return g},removeProperty:function(e){var f=this._removeObject(b,"_properties",e);if(f){this._hydratedPropertyCount--}return f},removeAllProperties:function(e){var f=this._removeAllObjects(b,"_properties",e);this._hydratedPropertyCount=0;return f},toJSON:function(){return this.jCal},toString:function(){return ICAL.stringify.component(this.jCal,this._designSet)}};a.fromString=function(e){return new a(ICAL.parse.component(e))};return a}());ICAL.Property=(function(){var e=0;var c=1;var b=2;var d=3;var a=ICAL.design;function f(h,g){this._parent=g||null;if(typeof(h)==="string"){this.jCal=[h,{},a.defaultType];this.jCal[b]=this.getDefaultType()}else{this.jCal=h}this._updateType()}f.prototype={get type(){return this.jCal[b]},get name(){return this.jCal[e]},get parent(){return this._parent},set parent(h){var g=!this._parent||(h&&h._designSet!=this._parent._designSet);this._parent=h;if(this.type==a.defaultType&&g){this.jCal[b]=this.getDefaultType();this._updateType()}return h},get _designSet(){return this.parent?this.parent._designSet:a.defaultSet},_updateType:function(){var h=this._designSet;if(this.type in h.value){var g=h.value[this.type];if("decorate" in h.value[this.type]){this.isDecorated=true}else{this.isDecorated=false}if(this.name in h.property){this.isMultiValue=("multiValue" in h.property[this.name]);this.isStructuredValue=("structuredValue" in h.property[this.name])}}},_hydrateValue:function(g){if(this._values&&this._values[g]){return this._values[g]}if(this.jCal.length<=(d+g)){return null}if(this.isDecorated){if(!this._values){this._values=[]}return(this._values[g]=this._decorate(this.jCal[d+g]))}else{return this.jCal[d+g]}},_decorate:function(g){return this._designSet.value[this.type].decorate(g,this)},_undecorate:function(g){return this._designSet.value[this.type].undecorate(g,this)},_setDecoratedValue:function(h,g){if(!this._values){this._values=[]}if(typeof(h)==="object"&&"icaltype" in h){this.jCal[d+g]=this._undecorate(h);this._values[g]=h}else{this.jCal[d+g]=h;this._values[g]=this._decorate(h)}},getParameter:function(g){if(g in this.jCal[c]){return this.jCal[c][g]}else{return undefined}},getFirstParameter:function(g){var h=this.getParameter(g);if(Array.isArray(h)){return h[0]}return h},setParameter:function(g,i){var h=g.toLowerCase();if(typeof i==="string"&&h in this._designSet.param&&"multiValue" in this._designSet.param[h]){i=[i]}this.jCal[c][g]=i},removeParameter:function(g){delete this.jCal[c][g]},getDefaultType:function(){var h=this.jCal[e];var g=this._designSet;if(h in g.property){var i=g.property[h];if("defaultType" in i){return i.defaultType}}return a.defaultType},resetType:function(g){this.removeAllValues();this.jCal[b]=g;this._updateType()},getFirstValue:function(){return this._hydrateValue(0)},getValues:function(){var h=this.jCal.length-d;if(h<1){return[]}var j=0;var g=[];for(;j<h;j++){g[j]=this._hydrateValue(j)}return g},removeAllValues:function(){if(this._values){this._values.length=0}this.jCal.length=3},setValues:function(h){if(!this.isMultiValue){throw new Error(this.name+": does not not support mulitValue.\noverride isMultiValue")}var g=h.length;var j=0;this.removeAllValues();if(g>0&&typeof(h[0])==="object"&&"icaltype" in h[0]){this.resetType(h[0].icaltype)}if(this.isDecorated){for(;j<g;j++){this._setDecoratedValue(h[j],j)}}else{for(;j<g;j++){this.jCal[d+j]=h[j]}}},setValue:function(g){this.removeAllValues();if(typeof(g)==="object"&&"icaltype" in g){this.resetType(g.icaltype)}if(this.isDecorated){this._setDecoratedValue(g,0)}else{this.jCal[d]=g}},toJSON:function(){return this.jCal},toICALString:function(){return ICAL.stringify.property(this.jCal,this._designSet,true)}};f.fromString=function(h,g){return new f(ICAL.parse.property(h,g))};return f}());ICAL.UtcOffset=(function(){function c(d){this.fromData(d)}c.prototype={hours:0,minutes:0,factor:1,icaltype:"utc-offset",clone:function(){return ICAL.UtcOffset.fromSeconds(this.toSeconds())},fromData:function(d){if(d){for(var e in d){if(d.hasOwnProperty(e)){this[e]=d[e]}}}this._normalize()},fromSeconds:function(e){var d=Math.abs(e);this.factor=e<0?-1:1;this.hours=ICAL.helpers.trunc(d/3600);d-=(this.hours*3600);this.minutes=ICAL.helpers.trunc(d/60);return this},toSeconds:function(){return this.factor*(60*this.minutes+3600*this.hours)},compare:function b(e){var f=this.toSeconds();var d=e.toSeconds();return(f>d)-(d>f)},_normalize:function(){var e=this.toSeconds();var d=this.factor;while(e<-43200){e+=97200}while(e>50400){e-=97200}this.fromSeconds(e);if(e==0){this.factor=d}},toICALString:function(){return ICAL.design.icalendar.value["utc-offset"].toICAL(this.toString())},toString:function a(){return(this.factor==1?"+":"-")+ICAL.helpers.pad2(this.hours)+":"+ICAL.helpers.pad2(this.minutes)}};c.fromString=function(d){var e={};e.factor=(d[0]==="+")?1:-1;e.hours=ICAL.helpers.strictParseInt(d.substr(1,2));e.minutes=ICAL.helpers.strictParseInt(d.substr(4,2));return new ICAL.UtcOffset(e)};c.fromSeconds=function(e){var d=new c();d.fromSeconds(e);return d};return c}());ICAL.Binary=(function(){function e(f){this.value=f}e.prototype={icaltype:"binary",decodeValue:function d(){return this._b64_decode(this.value)},setEncodedValue:function a(f){this.value=this._b64_encode(f)},_b64_encode:function b(o){var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var j,h,g,t,s,q,p,u,n=0,v=0,m="",l=[];if(!o){return o}do{j=o.charCodeAt(n++);h=o.charCodeAt(n++);g=o.charCodeAt(n++);u=j<<16|h<<8|g;t=u>>18&63;s=u>>12&63;q=u>>6&63;p=u&63;l[v++]=k.charAt(t)+k.charAt(s)+k.charAt(q)+k.charAt(p)}while(n<o.length);m=l.join("");var f=o.length%3;return(f?m.slice(0,f-3):m)+"===".slice(f||3)},_b64_decode:function c(n){var j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var h,g,f,r,q,p,o,s,m=0,t=0,k="",l=[];if(!n){return n}n+="";do{r=j.indexOf(n.charAt(m++));q=j.indexOf(n.charAt(m++));p=j.indexOf(n.charAt(m++));o=j.indexOf(n.charAt(m++));s=r<<18|q<<12|p<<6|o;h=s>>16&255;g=s>>8&255;f=s&255;if(p==64){l[t++]=String.fromCharCode(h)}else{if(o==64){l[t++]=String.fromCharCode(h,g)}else{l[t++]=String.fromCharCode(h,g,f)}}}while(m<n.length);k=l.join("");return k},toString:function(){return this.value}};e.fromString=function(f){return new e(f)};return e}());(function(){ICAL.Period=function d(f){this.wrappedJSObject=this;if(f&&"start" in f){if(f.start&&!(f.start instanceof ICAL.Time)){throw new TypeError(".start must be an instance of ICAL.Time")}this.start=f.start}if(f&&f.end&&f.duration){throw new Error("cannot accept both end and duration")}if(f&&"end" in f){if(f.end&&!(f.end instanceof ICAL.Time)){throw new TypeError(".end must be an instance of ICAL.Time")}this.end=f.end}if(f&&"duration" in f){if(f.duration&&!(f.duration instanceof ICAL.Duration)){throw new TypeError(".duration must be an instance of ICAL.Duration")}this.duration=f.duration}};ICAL.Period.prototype={start:null,end:null,duration:null,icalclass:"icalperiod",icaltype:"period",clone:function(){return ICAL.Period.fromData({start:this.start?this.start.clone():null,end:this.end?this.end.clone():null,duration:this.duration?this.duration.clone():null})},getDuration:function c(){if(this.duration){return this.duration}else{return this.end.subtractDate(this.start)}},getEnd:function(){if(this.end){return this.end}else{var f=this.start.clone();f.addDuration(this.duration);return f}},toString:function b(){return this.start+"/"+(this.end||this.duration)},toJSON:function(){return[this.start.toString(),(this.end||this.duration).toString()]},toICALString:function(){return this.start.toICALString()+"/"+(this.end||this.duration).toICALString()}};ICAL.Period.fromString=function e(i,j){var h=i.split("/");if(h.length!==2){throw new Error('Invalid string value: "'+i+'" must contain a "/" char.')}var g={start:ICAL.Time.fromDateTimeString(h[0],j)};var f=h[1];if(ICAL.Duration.isValueString(f)){g.duration=ICAL.Duration.fromString(f)}else{g.end=ICAL.Time.fromDateTimeString(f,j)}return new ICAL.Period(g)};ICAL.Period.fromData=function a(f){return new ICAL.Period(f)};ICAL.Period.fromJSON=function(f,g){if(ICAL.Duration.isValueString(f[1])){return ICAL.Period.fromData({start:ICAL.Time.fromDateTimeString(f[0],g),duration:ICAL.Duration.fromString(f[1])})}else{return ICAL.Period.fromData({start:ICAL.Time.fromDateTimeString(f[0],g),end:ICAL.Time.fromDateTimeString(f[1],g)})}}})();(function(){var e=/([PDWHMTS]{1,1})/;ICAL.Duration=function k(o){this.wrappedJSObject=this;this.fromData(o)};ICAL.Duration.prototype={weeks:0,days:0,hours:0,minutes:0,seconds:0,isNegative:false,icalclass:"icalduration",icaltype:"duration",clone:function j(){return ICAL.Duration.fromData(this)},toSeconds:function m(){var o=this.seconds+60*this.minutes+3600*this.hours+86400*this.days+7*86400*this.weeks;return(this.isNegative?-o:o)},fromSeconds:function a(p){var o=Math.abs(p);this.isNegative=(p<0);this.days=ICAL.helpers.trunc(o/86400);if(this.days%7==0){this.weeks=this.days/7;this.days=0}else{this.weeks=0}o-=(this.days+7*this.weeks)*86400;this.hours=ICAL.helpers.trunc(o/3600);o-=this.hours*3600;this.minutes=ICAL.helpers.trunc(o/60);o-=this.minutes*60;this.seconds=o;return this},fromData:function n(o){var r=["weeks","days","hours","minutes","seconds","isNegative"];for(var p in r){if(!r.hasOwnProperty(p)){continue}var q=r[p];if(o&&q in o){this[q]=o[q]}else{this[q]=0}}},reset:function h(){this.isNegative=false;this.weeks=0;this.days=0;this.hours=0;this.minutes=0;this.seconds=0},compare:function b(q){var o=this.toSeconds();var p=q.toSeconds();return(o>p)-(o<p)},normalize:function g(){this.fromSeconds(this.toSeconds())},toString:function d(){if(this.toSeconds()==0){return"PT0S"}else{var o="";if(this.isNegative){o+="-"}o+="P";if(this.weeks){o+=this.weeks+"W"}if(this.days){o+=this.days+"D"}if(this.hours||this.minutes||this.seconds){o+="T";if(this.hours){o+=this.hours+"H"}if(this.minutes){o+=this.minutes+"M"}if(this.seconds){o+=this.seconds+"S"}}return o}},toICALString:function(){return this.toString()}};ICAL.Duration.fromSeconds=function f(o){return(new ICAL.Duration()).fromSeconds(o)};function l(s,r,p){var q;switch(s){case"P":if(r&&r==="-"){p.isNegative=true}else{p.isNegative=false}break;case"D":q="days";break;case"W":q="weeks";break;case"H":q="hours";break;case"M":q="minutes";break;case"S":q="seconds";break;default:return 0}if(q){if(!r&&r!==0){throw new Error('invalid duration value: Missing number before "'+s+'"')}var o=parseInt(r,10);if(ICAL.helpers.isStrictlyNaN(o)){throw new Error('invalid duration value: Invalid number "'+r+'" before "'+s+'"')}p[q]=o}return 1}ICAL.Duration.isValueString=function(o){return(o[0]==="P"||o[1]==="P")};ICAL.Duration.fromString=function c(o){var t=0;var s=Object.create(null);var r=0;while((t=o.search(e))!==-1){var q=o[t];var p=o.substr(0,t);o=o.substr(t+1);r+=l(q,p,s)}if(r<2){throw new Error('invalid duration value: Not enough duration components in "'+o+'"')}return new ICAL.Duration(s)};ICAL.Duration.fromData=function i(o){return new ICAL.Duration(o)}})();(function(){var e=["tzid","location","tznames","latitude","longitude"];ICAL.Timezone=function j(k){this.wrappedJSObject=this;this.fromData(k)};ICAL.Timezone.prototype={tzid:"",location:"",tznames:"",latitude:0,longitude:0,component:null,expandedUntilYear:0,icalclass:"icaltimezone",fromData:function g(k){this.expandedUntilYear=0;this.changes=[];if(k instanceof ICAL.Component){this.component=k}else{if(k&&"component" in k){if(typeof k.component=="string"){var m=ICAL.parse(k.component);this.component=new ICAL.Component(m)}else{if(k.component instanceof ICAL.Component){this.component=k.component}else{this.component=null}}}for(var l in e){if(e.hasOwnProperty(l)){var n=e[l];if(k&&n in k){this[n]=k[n]}}}}if(this.component instanceof ICAL.Component&&!this.tzid){this.tzid=this.component.getFirstPropertyValue("tzid")}return this},utcOffset:function i(q){if(this==ICAL.Timezone.utcTimezone||this==ICAL.Timezone.localTimezone){return 0}this._ensureCoverage(q.year);if(!this.changes.length){return 0}var r={year:q.year,month:q.month,day:q.day,hour:q.hour,minute:q.minute,second:q.second};var o=this._findNearbyChange(r);var m=-1;var l=1;for(;;){var t=ICAL.helpers.clone(this.changes[o],true);if(t.utcOffset<t.prevUtcOffset){ICAL.Timezone.adjust_change(t,0,0,0,t.utcOffset)}else{ICAL.Timezone.adjust_change(t,0,0,0,t.prevUtcOffset)}var u=ICAL.Timezone._compare_change_fn(r,t);if(u>=0){m=o}else{l=-1}if(l==-1&&m!=-1){break}o+=l;if(o<0){return 0}if(o>=this.changes.length){break}}var n=this.changes[m];var s=n.utcOffset-n.prevUtcOffset;if(s<0&&m>0){var k=ICAL.helpers.clone(n,true);ICAL.Timezone.adjust_change(k,0,0,0,k.prevUtcOffset);if(ICAL.Timezone._compare_change_fn(r,k)<0){var v=this.changes[m-1];var p=false;if(n.is_daylight!=p&&v.is_daylight==p){n=v}}}return n.utcOffset},_findNearbyChange:function d(l){var k=ICAL.helpers.binsearchInsert(this.changes,l,ICAL.Timezone._compare_change_fn);if(k>=this.changes.length){return this.changes.length-1}return k},_ensureCoverage:function(n){if(ICAL.Timezone._minimumExpansionYear==-1){var o=ICAL.Time.now();ICAL.Timezone._minimumExpansionYear=o.year}var m=n;if(m<ICAL.Timezone._minimumExpansionYear){m=ICAL.Timezone._minimumExpansionYear}m+=ICAL.Timezone.EXTRA_COVERAGE;if(m>ICAL.Timezone.MAX_YEAR){m=ICAL.Timezone.MAX_YEAR}if(!this.changes.length||this.expandedUntilYear<n){var p=this.component.getAllSubcomponents();var l=p.length;var k=0;for(;k<l;k++){this._expandComponent(p[k],m,this.changes)}this.changes.sort(ICAL.Timezone._compare_change_fn);this.expandedUntilYear=m}},_expandComponent:function(u,r,v){if(!u.hasProperty("dtstart")||!u.hasProperty("tzoffsetto")||!u.hasProperty("tzoffsetfrom")){return null}var x=u.getFirstProperty("dtstart").getFirstValue();var t;function l(y){return y.factor*(y.hours*3600+y.minutes*60)}function m(){var y={};y.is_daylight=(u.name=="daylight");y.utcOffset=l(u.getFirstProperty("tzoffsetto").getFirstValue());y.prevUtcOffset=l(u.getFirstProperty("tzoffsetfrom").getFirstValue());return y}if(!u.hasProperty("rrule")&&!u.hasProperty("rdate")){t=m();t.year=x.year;t.month=x.month;t.day=x.day;t.hour=x.hour;t.minute=x.minute;t.second=x.second;ICAL.Timezone.adjust_change(t,0,0,0,-t.prevUtcOffset);v.push(t)}else{var s=u.getAllProperties("rdate");for(var k in s){if(!s.hasOwnProperty(k)){continue}var o=s[k];var n=o.getFirstValue();t=m();t.year=n.year;t.month=n.month;t.day=n.day;if(n.isDate){t.hour=x.hour;t.minute=x.minute;t.second=x.second;if(x.zone!=ICAL.Timezone.utcTimezone){ICAL.Timezone.adjust_change(t,0,0,0,-t.prevUtcOffset)}}else{t.hour=n.hour;t.minute=n.minute;t.second=n.second;if(n.zone!=ICAL.Timezone.utcTimezone){ICAL.Timezone.adjust_change(t,0,0,0,-t.prevUtcOffset)}}v.push(t)}var w=u.getFirstProperty("rrule");if(w){w=w.getFirstValue();t=m();if(w.until&&w.until.zone==ICAL.Timezone.utcTimezone){w.until.adjust(0,0,0,t.prevUtcOffset);w.until.zone=ICAL.Timezone.localTimezone}var q=w.iterator(x);var p;while((p=q.next())){t=m();if(p.year>r||!p){break}t.year=p.year;t.month=p.month;t.day=p.day;t.hour=p.hour;t.minute=p.minute;t.second=p.second;t.isDate=p.isDate;ICAL.Timezone.adjust_change(t,0,0,0,-t.prevUtcOffset);v.push(t)}}}return v},toString:function c(){return(this.tznames?this.tznames:this.tzid)}};ICAL.Timezone._compare_change_fn=function b(l,k){if(l.year<k.year){return -1}else{if(l.year>k.year){return 1}}if(l.month<k.month){return -1}else{if(l.month>k.month){return 1}}if(l.day<k.day){return -1}else{if(l.day>k.day){return 1}}if(l.hour<k.hour){return -1}else{if(l.hour>k.hour){return 1}}if(l.minute<k.minute){return -1}else{if(l.minute>k.minute){return 1}}if(l.second<k.second){return -1}else{if(l.second>k.second){return 1}}return 0};ICAL.Timezone.convert_time=function a(k,l,n){if(k.isDate||l.tzid==n.tzid||l==ICAL.Timezone.localTimezone||n==ICAL.Timezone.localTimezone){k.zone=n;return k}var m=l.utcOffset(k);k.adjust(0,0,0,-m);m=n.utcOffset(k);k.adjust(0,0,0,m);return null};ICAL.Timezone.fromData=function f(k){var l=new ICAL.Timezone();return l.fromData(k)};ICAL.Timezone.utcTimezone=ICAL.Timezone.fromData({tzid:"UTC"});ICAL.Timezone.localTimezone=ICAL.Timezone.fromData({tzid:"floating"});ICAL.Timezone.adjust_change=function h(o,n,k,l,m){return ICAL.Time.prototype.adjust.call(o,n,k,l,m,o)};ICAL.Timezone._minimumExpansionYear=-1;ICAL.Timezone.MAX_YEAR=2035;ICAL.Timezone.EXTRA_COVERAGE=5})();ICAL.TimezoneService=(function(){var a;var b={reset:function(){a=Object.create(null);var c=ICAL.Timezone.utcTimezone;a.Z=c;a.UTC=c;a.GMT=c},has:function(c){return !!a[c]},get:function(c){return a[c]},register:function(c,d){if(c instanceof ICAL.Component){if(c.name==="vtimezone"){d=new ICAL.Timezone(c);c=d.tzid}}if(d instanceof ICAL.Timezone){a[c]=d}else{throw new TypeError("timezone must be ICAL.Timezone or ICAL.Component")}},remove:function(c){return(delete a[c])}};b.reset();return b}());(function(){ICAL.Time=function F(N,M){this.wrappedJSObject=this;var O=this._time=Object.create(null);O.year=0;O.month=1;O.day=1;O.hour=0;O.minute=0;O.second=0;O.isDate=false;this.fromData(N,M)};ICAL.Time._dowCache={};ICAL.Time._wnCache={};ICAL.Time.prototype={icalclass:"icaltime",_cachedUnixTime:null,get icaltype(){return this.isDate?"date":"date-time"},zone:null,_pendingNormalization:false,clone:function(){return new ICAL.Time(this._time,this.zone)},reset:function E(){this.fromData(ICAL.Time.epochTime);this.zone=ICAL.Timezone.utcTimezone},resetTo:function D(P,R,N,M,S,O,Q){this.fromData({year:P,month:R,day:N,hour:M,minute:S,second:O,zone:Q})},fromJSDate:function K(N,M){if(!N){this.reset()}else{if(M){this.zone=ICAL.Timezone.utcTimezone;this.year=N.getUTCFullYear();this.month=N.getUTCMonth()+1;this.day=N.getUTCDate();this.hour=N.getUTCHours();this.minute=N.getUTCMinutes();this.second=N.getUTCSeconds()}else{this.zone=ICAL.Timezone.localTimezone;this.year=N.getFullYear();this.month=N.getMonth()+1;this.day=N.getDate();this.hour=N.getHours();this.minute=N.getMinutes();this.second=N.getSeconds()}}this._cachedUnixTime=null;return this},fromData:function s(N,P){if(N){for(var O in N){if(Object.prototype.hasOwnProperty.call(N,O)){if(O==="icaltype"){continue}this[O]=N[O]}}}if(P){this.zone=P}if(N&&!("isDate" in N)){this.isDate=!("hour" in N)}else{if(N&&("isDate" in N)){this.isDate=N.isDate}}if(N&&"timezone" in N){var M=ICAL.TimezoneService.get(N.timezone);this.zone=M||ICAL.Timezone.localTimezone}if(N&&"zone" in N){this.zone=N.zone}if(!this.zone){this.zone=ICAL.Timezone.localTimezone}this._cachedUnixTime=null;return this},dayOfWeek:function m(){var N=(this.year<<9)+(this.month<<5)+this.day;if(N in ICAL.Time._dowCache){return ICAL.Time._dowCache[N]}var P=this.day;var M=this.month+(this.month<3?12:0);var Q=this.year-(this.month<3?1:0);var O=(P+Q+ICAL.helpers.trunc(((M+1)*26)/10)+ICAL.helpers.trunc(Q/4));if(true){O+=ICAL.helpers.trunc(Q/100)*6+ICAL.helpers.trunc(Q/400)}else{O+=5}O=((O+6)%7)+1;ICAL.Time._dowCache[N]=O;return O},dayOfYear:function l(){var N=(ICAL.Time.isLeapYear(this.year)?1:0);var M=ICAL.Time.daysInYearPassedMonth;return M[N][this.month-1]+this.day},startOfWeek:function x(N){var O=N||ICAL.Time.SUNDAY;var M=this.clone();M.day-=((this.dayOfWeek()+7-O)%7);M.isDate=true;M.hour=0;M.minute=0;M.second=0;return M},endOfWeek:function y(N){var O=N||ICAL.Time.SUNDAY;var M=this.clone();M.day+=(7-this.dayOfWeek()+O-ICAL.Time.SUNDAY)%7;M.isDate=true;M.hour=0;M.minute=0;M.second=0;return M},startOfMonth:function a(){var M=this.clone();M.day=1;M.isDate=true;M.hour=0;M.minute=0;M.second=0;return M},endOfMonth:function i(){var M=this.clone();M.day=ICAL.Time.daysInMonth(M.month,M.year);M.isDate=true;M.hour=0;M.minute=0;M.second=0;return M},startOfYear:function B(){var M=this.clone();M.day=1;M.month=1;M.isDate=true;M.hour=0;M.minute=0;M.second=0;return M},endOfYear:function C(){var M=this.clone();M.day=31;M.month=12;M.isDate=true;M.hour=0;M.minute=0;M.second=0;return M},startDoyWeek:function z(M){var O=M||ICAL.Time.SUNDAY;var N=this.dayOfWeek()-O;if(N<0){N+=7}return this.dayOfYear()-N},getDominicalLetter:function(){return ICAL.Time.getDominicalLetter(this.year)},nthWeekDay:function h(P,S){var M=ICAL.Time.daysInMonth(this.month,this.year);var T;var U=S;var N=0;var O=this.clone();if(U>=0){O.day=1;if(U!=0){U--}N=O.day;var V=O.dayOfWeek();var R=P-V;if(R<0){R+=7}N+=R;N-=P;T=P}else{O.day=M;var Q=O.dayOfWeek();U++;T=(Q-P);if(T<0){T+=7}T=M-T}T+=U*7;return N+T},isNthWeekDay:function(O,M){var P=this.dayOfWeek();if(M===0&&P===O){return true}var N=this.nthWeekDay(O,M);if(N===this.day){return true}return false},weekNumber:function o(O){var M=(this.year<<12)+(this.month<<8)+(this.day<<3)+O;if(M in ICAL.Time._wnCache){return ICAL.Time._wnCache[M]}var Q;var P=this.clone();P.isDate=true;var S=this.year;if(P.month==12&&P.day>25){Q=ICAL.Time.weekOneStarts(S+1,O);if(P.compare(Q)<0){Q=ICAL.Time.weekOneStarts(S,O)}else{S++}}else{Q=ICAL.Time.weekOneStarts(S,O);if(P.compare(Q)<0){Q=ICAL.Time.weekOneStarts(--S,O)}}var N=(P.subtractDate(Q).toSeconds()/86400);var R=ICAL.helpers.trunc(N/7)+1;ICAL.Time._wnCache[M]=R;return R},addDuration:function L(Q){var P=(Q.isNegative?-1:1);var O=this.second;var R=this.minute;var M=this.hour;var N=this.day;O+=P*Q.seconds;R+=P*Q.minutes;M+=P*Q.hours;N+=P*Q.days;N+=P*7*Q.weeks;this.second=O;this.minute=R;this.hour=M;this.day=N;this._cachedUnixTime=null},subtractDate:function c(O){var N=this.toUnixTime()+this.utcOffset();var M=O.toUnixTime()+O.utcOffset();return ICAL.Duration.fromSeconds(N-M)},subtractDateTz:function g(O){var N=this.toUnixTime();var M=O.toUnixTime();return ICAL.Duration.fromSeconds(N-M)},compare:function t(N){var O=this.toUnixTime();var M=N.toUnixTime();if(O>M){return 1}if(M>O){return -1}return 0},compareDateOnlyTz:function e(N,R){function P(S){return ICAL.Time._cmp_attr(O,M,S)}var O=this.convertToZone(R);var M=N.convertToZone(R);var Q=0;if((Q=P("year"))!=0){return Q}if((Q=P("month"))!=0){return Q}if((Q=P("day"))!=0){return Q}return Q},convertToZone:function b(M){var O=this.clone();var N=(this.zone.tzid==M.tzid);if(!this.isDate&&!N){ICAL.Timezone.convert_time(O,this.zone,M)}O.zone=M;return O},utcOffset:function q(){if(this.zone==ICAL.Timezone.localTimezone||this.zone==ICAL.Timezone.utcTimezone){return 0}else{return this.zone.utcOffset(this)}},toICALString:function(){var M=this.toString();if(M.length>10){return ICAL.design.icalendar.value["date-time"].toICAL(M)}else{return ICAL.design.icalendar.value.date.toICAL(M)}},toString:function d(){var M=this.year+"-"+ICAL.helpers.pad2(this.month)+"-"+ICAL.helpers.pad2(this.day);if(!this.isDate){M+="T"+ICAL.helpers.pad2(this.hour)+":"+ICAL.helpers.pad2(this.minute)+":"+ICAL.helpers.pad2(this.second);if(this.zone===ICAL.Timezone.utcTimezone){M+="Z"}}return M},toJSDate:function v(){if(this.zone==ICAL.Timezone.localTimezone){if(this.isDate){return new Date(this.year,this.month-1,this.day)}else{return new Date(this.year,this.month-1,this.day,this.hour,this.minute,this.second,0)}}else{return new Date(this.toUnixTime()*1000)}},_normalize:function H(){var M=this._time.isDate;if(this._time.isDate){this._time.hour=0;this._time.minute=0;this._time.second=0}this.adjust(0,0,0,0);return this},adjust:function u(Z,U,M,aa,Q){var X,R,W=0,P=0;var O,T,V,Y;var N;var S=Q||this._time;if(!S.isDate){O=S.second+aa;S.second=O%60;X=ICAL.helpers.trunc(O/60);if(S.second<0){S.second+=60;X--}T=S.minute+M+X;S.minute=T%60;R=ICAL.helpers.trunc(T/60);if(S.minute<0){S.minute+=60;R--}V=S.hour+U+R;S.hour=V%24;W=ICAL.helpers.trunc(V/24);if(S.hour<0){S.hour+=24;W--}}if(S.month>12){P=ICAL.helpers.trunc((S.month-1)/12)}else{if(S.month<1){P=ICAL.helpers.trunc(S.month/12)-1}}S.year+=P;S.month-=12*P;Y=S.day+Z+W;if(Y>0){for(;;){N=ICAL.Time.daysInMonth(S.month,S.year);if(Y<=N){break}S.month++;if(S.month>12){S.year++;S.month=1}Y-=N}}else{while(Y<=0){if(S.month==1){S.year--;S.month=12}else{S.month--}Y+=ICAL.Time.daysInMonth(S.month,S.year)}}S.day=Y;this._cachedUnixTime=null;return this},fromUnixTime:function f(N){this.zone=ICAL.Timezone.utcTimezone;var M=ICAL.Time.epochTime.clone();M.adjust(0,0,0,N);this.year=M.year;this.month=M.month;this.day=M.day;this.hour=M.hour;this.minute=M.minute;this.second=Math.floor(M.second);this._cachedUnixTime=null},toUnixTime:function k(){if(this._cachedUnixTime!==null){return this._cachedUnixTime}var N=this.utcOffset();var M=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second-N);this._cachedUnixTime=M/1000;return this._cachedUnixTime},toJSON:function(){var Q=["year","month","day","hour","minute","second","isDate"];var N=Object.create(null);var O=0;var M=Q.length;var P;for(;O<M;O++){P=Q[O];N[P]=this[P]}if(this.zone){N.timezone=this.zone.tzid}return N}};(function G(){function M(N){Object.defineProperty(ICAL.Time.prototype,N,{get:function P(){if(this._pendingNormalization){this._normalize();this._pendingNormalization=false}return this._time[N]},set:function O(Q){if(N==="isDate"&&Q&&!this._time.isDate){this.adjust(0,0,0,0)}this._cachedUnixTime=null;this._pendingNormalization=true;this._time[N]=Q;return Q}})}if("defineProperty" in Object){M("year");M("month");M("day");M("hour");M("minute");M("second");M("isDate")}})();ICAL.Time.daysInMonth=function n(N,M){var O=[0,31,28,31,30,31,30,31,31,30,31,30,31];var P=30;if(N<1||N>12){return P}P=O[N];if(N==2){P+=ICAL.Time.isLeapYear(M)}return P};ICAL.Time.isLeapYear=function p(M){if(M<=1752){return((M%4)==0)}else{return(((M%4==0)&&(M%100!=0))||(M%400==0))}};ICAL.Time.fromDayOfYear=function I(P,M){var O=M;var S=P;var N=new ICAL.Time();N.auto_normalize=false;var Q=(ICAL.Time.isLeapYear(O)?1:0);if(S<1){O--;Q=(ICAL.Time.isLeapYear(O)?1:0);S+=ICAL.Time.daysInYearPassedMonth[Q][12];return ICAL.Time.fromDayOfYear(S,O)}else{if(S>ICAL.Time.daysInYearPassedMonth[Q][12]){Q=(ICAL.Time.isLeapYear(O)?1:0);S-=ICAL.Time.daysInYearPassedMonth[Q][12];O++;return ICAL.Time.fromDayOfYear(S,O)}}N.year=O;N.isDate=true;for(var R=11;R>=0;R--){if(S>ICAL.Time.daysInYearPassedMonth[Q][R]){N.month=R+1;N.day=S-ICAL.Time.daysInYearPassedMonth[Q][R];break}}N.auto_normalize=true;return N};ICAL.Time.fromStringv2=function r(M){return new ICAL.Time({year:parseInt(M.substr(0,4),10),month:parseInt(M.substr(5,2),10),day:parseInt(M.substr(8,2),10),isDate:true})};ICAL.Time.fromDateString=function(M){return new ICAL.Time({year:ICAL.helpers.strictParseInt(M.substr(0,4)),month:ICAL.helpers.strictParseInt(M.substr(5,2)),day:ICAL.helpers.strictParseInt(M.substr(8,2)),isDate:true})};ICAL.Time.fromDateTimeString=function(N,P){if(N.length<19){throw new Error('invalid date-time value: "'+N+'"')}var M;if(N[19]&&N[19]==="Z"){M="Z"}else{if(P){M=P.getParameter("tzid")}}var O=new ICAL.Time({year:ICAL.helpers.strictParseInt(N.substr(0,4)),month:ICAL.helpers.strictParseInt(N.substr(5,2)),day:ICAL.helpers.strictParseInt(N.substr(8,2)),hour:ICAL.helpers.strictParseInt(N.substr(11,2)),minute:ICAL.helpers.strictParseInt(N.substr(14,2)),second:ICAL.helpers.strictParseInt(N.substr(17,2)),timezone:M});return O};ICAL.Time.fromString=function r(M){if(M.length>10){return ICAL.Time.fromDateTimeString(M)}else{return ICAL.Time.fromDateString(M)}};ICAL.Time.fromJSDate=function J(O,N){var M=new ICAL.Time();return M.fromJSDate(O,N)};ICAL.Time.fromData=function s(M,O){var N=new ICAL.Time();return N.fromData(M,O)};ICAL.Time.now=function A(){return ICAL.Time.fromJSDate(new Date(),false)};ICAL.Time.weekOneStarts=function j(M,N){var O=ICAL.Time.fromData({year:M,month:1,day:1,isDate:true});var Q=O.dayOfWeek();var P=N||ICAL.Time.DEFAULT_WEEK_START;if(Q>ICAL.Time.THURSDAY){O.day+=7}if(P>ICAL.Time.THURSDAY){O.day-=7}O.day-=Q-P;return O};ICAL.Time.getDominicalLetter=function(O){var M="GFEDCBA";var P=(O+(O/4|0)+(O/400|0)-(O/100|0)-1)%7;var N=ICAL.Time.isLeapYear(O);if(N){return M[(P+6)%7]+M[P]}else{return M[P]}};ICAL.Time.epochTime=ICAL.Time.fromData({year:1970,month:1,day:1,hour:0,minute:0,second:0,isDate:false,timezone:"Z"});ICAL.Time._cmp_attr=function w(O,N,M){if(O[M]>N[M]){return 1}if(O[M]<N[M]){return -1}return 0};ICAL.Time.daysInYearPassedMonth=[[0,31,59,90,120,151,181,212,243,273,304,334,365],[0,31,60,91,121,152,182,213,244,274,305,335,366]];ICAL.Time.SUNDAY=1;ICAL.Time.MONDAY=2;ICAL.Time.TUESDAY=3;ICAL.Time.WEDNESDAY=4;ICAL.Time.THURSDAY=5;ICAL.Time.FRIDAY=6;ICAL.Time.SATURDAY=7;ICAL.Time.DEFAULT_WEEK_START=ICAL.Time.MONDAY})();(function(){ICAL.VCardTime=function(d,b,c){this.wrappedJSObject=this;var e=this._time=Object.create(null);e.year=null;e.month=null;e.day=null;e.hour=null;e.minute=null;e.second=null;this.icaltype=c||"date-and-or-time";this.fromData(d,b)};ICAL.helpers.inherits(ICAL.Time,ICAL.VCardTime,{icalclass:"vcardtime",icaltype:"date-and-or-time",zone:null,clone:function(){return new ICAL.VCardTime(this._time,this.zone,this.icaltype)},_normalize:function(){return this},utcOffset:function(){if(this.zone instanceof ICAL.UtcOffset){return this.zone.toSeconds()}else{return ICAL.Time.prototype.utcOffset.apply(this,arguments)}},toICALString:function(){return ICAL.design.vcard.value[this.icaltype].toICAL(this.toString())},toString:function a(){var t=ICAL.helpers.pad2;var r=this.year,f=this.month,p=this.day;var l=this.hour,j=this.minute,v=this.second;var g=r!==null,q=f!==null,e=p!==null;var u=l!==null,i=j!==null,c=v!==null;var n=(g?t(r)+(q||e?"-":""):(q||e?"--":""))+(q?t(f):"")+(e?"-"+t(p):"");var b=(u?t(l):"-")+(u&&i?":":"")+(i?t(j):"")+(!u&&!i?"-":"")+(i&&c?":":"")+(c?t(v):"");var o;if(this.zone===ICAL.Timezone.utcTimezone){o="Z"}else{if(this.zone instanceof ICAL.UtcOffset){o=this.zone.toString()}else{if(this.zone===ICAL.Timezone.localTimezone){o=""}else{if(this.zone instanceof ICAL.Timezone){var k=ICAL.UtcOffset.fromSeconds(this.zone.utcOffset(this));o=k.toString()}else{o=""}}}}switch(this.icaltype){case"time":return b+o;case"date-and-or-time":case"date-time":return n+(b=="--"?"":"T"+b+o);case"date":return n}return null}});ICAL.VCardTime.fromDateAndOrTimeString=function(i,n){function g(o,r,t){return o?ICAL.helpers.strictParseInt(o.substr(r,t)):null}var h=i.split("T");var f=h[0],q=h[1];var d=q?ICAL.design.vcard.value.time._splitZone(q):[];var k=d[0],p=d[1];var c=ICAL.helpers.strictParseInt;var j=f?f.length:0;var b=p?p.length:0;var m=f&&f[0]=="-"&&f[1]=="-";var l=p&&p[0]=="-";var e={year:m?null:g(f,0,4),month:m&&(j==4||j==7)?g(f,2,2):j==7?g(f,5,2):j==10?g(f,5,2):null,day:j==5?g(f,3,2):j==7&&m?g(f,5,2):j==10?g(f,8,2):null,hour:l?null:g(p,0,2),minute:l&&b==3?g(p,1,2):b>4?l?g(p,1,2):g(p,3,2):null,second:b==4?g(p,2,2):b==6?g(p,4,2):b==8?g(p,6,2):null};if(k=="Z"){k=ICAL.Timezone.utcTimezone}else{if(k&&k[3]==":"){k=ICAL.UtcOffset.fromString(k)}else{k=null}}return new ICAL.VCardTime(e,k,n)}})();(function(){var u={SU:ICAL.Time.SUNDAY,MO:ICAL.Time.MONDAY,TU:ICAL.Time.TUESDAY,WE:ICAL.Time.WEDNESDAY,TH:ICAL.Time.THURSDAY,FR:ICAL.Time.FRIDAY,SA:ICAL.Time.SATURDAY};var p={};for(var t in u){if(u.hasOwnProperty(t)){p[u[t]]=t}}var j=["BYSECOND","BYMINUTE","BYHOUR","BYDAY","BYMONTHDAY","BYYEARDAY","BYWEEKNO","BYMONTH","BYSETPOS"];ICAL.Recur=function k(v){this.wrappedJSObject=this;this.parts={};if(v&&typeof(v)==="object"){this.fromData(v)}};ICAL.Recur.prototype={parts:null,interval:1,wkst:ICAL.Time.MONDAY,until:null,count:null,freq:null,icalclass:"icalrecur",icaltype:"recur",iterator:function(v){return new ICAL.RecurIterator({rule:this,dtstart:v})},clone:function s(){return new ICAL.Recur(this.toJSON())},isFinite:function b(){return !!(this.count||this.until)},isByCount:function o(){return !!(this.count&&!this.until)},addComponent:function l(v,w){var x=v.toUpperCase();if(x in this.parts){this.parts[x].push(w)}else{this.parts[x]=[w]}},setComponent:function d(w,v){this.parts[w.toUpperCase()]=v.slice()},getComponent:function n(v){var w=v.toUpperCase();return(w in this.parts?this.parts[w].slice():[])},getNextOccurrence:function a(z,w){var v=this.iterator(z);var x,y;do{x=v.next()}while(x&&x.compare(w)<=0);if(x&&w.zone){x.zone=w.zone}return x},fromData:function(x){for(var w in x){var v=w.toUpperCase();if(v in q){if(Array.isArray(x[w])){this.parts[v]=x[w]}else{this.parts[v]=[x[w]]}}else{this[w]=x[w]}}if(this.interval&&typeof this.interval!="number"){e.INTERVAL(this.interval,this)}if(this.wkst&&typeof this.wkst!="number"){this.wkst=ICAL.Recur.icalDayToNumericDay(this.wkst)}if(this.until&&!(this.until instanceof ICAL.Time)){this.until=ICAL.Time.fromString(this.until)}},toJSON:function(){var x=Object.create(null);x.freq=this.freq;if(this.count){x.count=this.count}if(this.interval>1){x.interval=this.interval}for(var w in this.parts){if(!this.parts.hasOwnProperty(w)){continue}var v=this.parts[w];if(Array.isArray(v)&&v.length==1){x[w.toLowerCase()]=v[0]}else{x[w.toLowerCase()]=ICAL.helpers.clone(this.parts[w])}}if(this.until){x.until=this.until.toString()}if("wkst" in this&&this.wkst!==ICAL.Time.DEFAULT_WEEK_START){x.wkst=ICAL.Recur.numericDayToIcalDay(this.wkst)}return x},toString:function r(){var w="FREQ="+this.freq;if(this.count){w+=";COUNT="+this.count}if(this.interval>1){w+=";INTERVAL="+this.interval}for(var v in this.parts){if(this.parts.hasOwnProperty(v)){w+=";"+v+"="+this.parts[v]}}if(this.until){w+=";UNTIL="+this.until.toICALString()}if("wkst" in this&&this.wkst!==ICAL.Time.DEFAULT_WEEK_START){w+=";WKST="+ICAL.Recur.numericDayToIcalDay(this.wkst)}return w}};function h(y,x,w,z){var v=z;if(z[0]==="+"){v=z.substr(1)}v=ICAL.helpers.strictParseInt(v);if(x!==undefined&&z<x){throw new Error(y+': invalid value "'+z+'" must be > '+x)}if(w!==undefined&&z>w){throw new Error(y+': invalid value "'+z+'" must be < '+x)}return v}ICAL.Recur.icalDayToNumericDay=function i(v){return u[v]};ICAL.Recur.numericDayToIcalDay=function c(v){return p[v]};var f=/^(SU|MO|TU|WE|TH|FR|SA)$/;var g=/^([+-])?(5[0-3]|[1-4][0-9]|[1-9])?(SU|MO|TU|WE|TH|FR|SA)$/;var m=["SECONDLY","MINUTELY","HOURLY","DAILY","WEEKLY","MONTHLY","YEARLY"];var e={FREQ:function(w,x,v){if(m.indexOf(w)!==-1){x.freq=w}else{throw new Error('invalid frequency "'+w+'" expected: "'+m.join(", ")+'"')}},COUNT:function(w,x,v){x.count=ICAL.helpers.strictParseInt(w)},INTERVAL:function(w,x,v){x.interval=ICAL.helpers.strictParseInt(w);if(x.interval<1){x.interval=1}},UNTIL:function(w,x,v){if(w.length>10){x.until=ICAL.design.icalendar.value["date-time"].fromICAL(w)}else{x.until=ICAL.design.icalendar.value.date.fromICAL(w)}if(!v){x.until=ICAL.Time.fromString(x.until)}},WKST:function(w,x,v){if(f.test(w)){x.wkst=ICAL.Recur.icalDayToNumericDay(w)}else{throw new Error('invalid WKST value "'+w+'"')}}};var q={BYSECOND:h.bind(this,"BYSECOND",0,60),BYMINUTE:h.bind(this,"BYMINUTE",0,59),BYHOUR:h.bind(this,"BYHOUR",0,23),BYDAY:function(v){if(g.test(v)){return v}else{throw new Error('invalid BYDAY value "'+v+'"')}},BYMONTHDAY:h.bind(this,"BYMONTHDAY",-31,31),BYYEARDAY:h.bind(this,"BYYEARDAY",-366,366),BYWEEKNO:h.bind(this,"BYWEEKNO",-53,53),BYMONTH:h.bind(this,"BYMONTH",0,12),BYSETPOS:h.bind(this,"BYSETPOS",-366,366)};ICAL.Recur.fromString=function(v){var w=ICAL.Recur._stringToData(v,false);return new ICAL.Recur(w)};ICAL.Recur.fromData=function(v){return new ICAL.Recur(v)};ICAL.Recur._stringToData=function(B,F){var w=Object.create(null);var I=B.split(";");var D=I.length;for(var A=0;A<D;A++){var z=I[A].split("=");var y=z[0].toUpperCase();var E=z[0].toLowerCase();var v=(F?E:y);var H=z[1];if(y in q){var G=H.split(",");var C=0;var x=G.length;for(;C<x;C++){G[C]=q[y](G[C])}w[v]=(G.length==1?G[0]:G)}else{if(y in e){e[y](H,w,F)}else{w[E]=H}}}return w}})();ICAL.RecurIterator=(function(){function v(E){this.fromData(E)}v.prototype={completed:false,rule:null,dtstart:null,last:null,occurrence_number:0,by_indices:null,initialized:false,by_data:null,days:null,days_index:0,fromData:function(E){this.rule=ICAL.helpers.formatClassType(E.rule,ICAL.Recur);if(!this.rule){throw new Error("iterator requires a (ICAL.Recur) rule")}this.dtstart=ICAL.helpers.formatClassType(E.dtstart,ICAL.Time);if(!this.dtstart){throw new Error("iterator requires a (ICAL.Time) dtstart")}if(E.by_data){this.by_data=E.by_data}else{this.by_data=ICAL.helpers.clone(this.rule.parts,true)}if(E.occurrence_number){this.occurrence_number=E.occurrence_number}this.days=E.days||[];if(E.last){this.last=ICAL.helpers.formatClassType(E.last,ICAL.Time)}this.by_indices=E.by_indices;if(!this.by_indices){this.by_indices={BYSECOND:0,BYMINUTE:0,BYHOUR:0,BYDAY:0,BYMONTH:0,BYWEEKNO:0,BYMONTHDAY:0}}this.initialized=E.initialized||false;if(!this.initialized){this.init()}},init:function w(){this.initialized=true;this.last=this.dtstart.clone();var H=this.by_data;if("BYDAY" in H){this.sort_byday_rules(H.BYDAY,this.rule.wkst)}if("BYYEARDAY" in H){if("BYMONTH" in H||"BYWEEKNO" in H||"BYMONTHDAY" in H||"BYDAY" in H){throw new Error("Invalid BYYEARDAY rule")}}if("BYWEEKNO" in H&&"BYMONTHDAY" in H){throw new Error("BYWEEKNO does not fit to BYMONTHDAY")}if(this.rule.freq=="MONTHLY"&&("BYYEARDAY" in H||"BYWEEKNO" in H)){throw new Error("For MONTHLY recurrences neither BYYEARDAY nor BYWEEKNO may appear")}if(this.rule.freq=="WEEKLY"&&("BYYEARDAY" in H||"BYMONTHDAY" in H)){throw new Error("For WEEKLY recurrences neither BYMONTHDAY nor BYYEARDAY may appear")}if(this.rule.freq!="YEARLY"&&"BYYEARDAY" in H){throw new Error("BYYEARDAY may only appear in YEARLY rules")}this.last.second=this.setup_defaults("BYSECOND","SECONDLY",this.dtstart.second);this.last.minute=this.setup_defaults("BYMINUTE","MINUTELY",this.dtstart.minute);this.last.hour=this.setup_defaults("BYHOUR","HOURLY",this.dtstart.hour);this.last.day=this.setup_defaults("BYMONTHDAY","DAILY",this.dtstart.day);this.last.month=this.setup_defaults("BYMONTH","MONTHLY",this.dtstart.month);if(this.rule.freq=="WEEKLY"){if("BYDAY" in H){var J=this.ruleDayOfWeek(H.BYDAY[0]);var K=J[0];var O=J[1];var F=O-this.last.dayOfWeek();if((this.last.dayOfWeek()<O&&F>=0)||F<0){this.last.day+=F}}else{var M=ICAL.Recur.numericDayToIcalDay(this.dtstart.dayOfWeek());H.BYDAY=[M]}}if(this.rule.freq=="YEARLY"){for(;;){this.expand_year_days(this.last.year);if(this.days.length>0){break}this.increment_year(this.rule.interval)}this._nextByYearDay()}if(this.rule.freq=="MONTHLY"&&this.has_by_data("BYDAY")){var N=null;var G=this.last.clone();var E=ICAL.Time.daysInMonth(this.last.month,this.last.year);for(var I in this.by_data.BYDAY){if(!this.by_data.BYDAY.hasOwnProperty(I)){continue}this.last=G.clone();var J=this.ruleDayOfWeek(this.by_data.BYDAY[I]);var K=J[0];var O=J[1];var L=this.last.nthWeekDay(O,K);if(K>=6||K<=-6){throw new Error("Malformed values in BYDAY part")}if(L>E||L<=0){if(N&&N.month==G.month){continue}while(L>E||L<=0){this.increment_month();E=ICAL.Time.daysInMonth(this.last.month,this.last.year);L=this.last.nthWeekDay(O,K)}}this.last.day=L;if(!N||this.last.compare(N)<0){N=this.last.clone()}}this.last=N.clone();if(this.has_by_data("BYMONTHDAY")){this._byDayAndMonthDay(true)}if(this.last.day>E||this.last.day==0){throw new Error("Malformed values in BYDAY part")}}else{if(this.has_by_data("BYMONTHDAY")){if(this.last.day<0){var E=ICAL.Time.daysInMonth(this.last.month,this.last.year);this.last.day=E+this.last.day+1}}}},next:function u(){var F=(this.last?this.last.clone():null);if((this.rule.count&&this.occurrence_number>=this.rule.count)||(this.rule.until&&this.last.compare(this.rule.until)>0)){this.completed=true;return null}if(this.occurrence_number==0&&this.last.compare(this.dtstart)>=0){this.occurrence_number++;return this.last}var E;do{E=1;switch(this.rule.freq){case"SECONDLY":this.next_second();break;case"MINUTELY":this.next_minute();break;case"HOURLY":this.next_hour();break;case"DAILY":this.next_day();break;case"WEEKLY":this.next_week();break;case"MONTHLY":E=this.next_month();break;case"YEARLY":this.next_year();break;default:return null}}while(!this.check_contracting_rules()||this.last.compare(this.dtstart)<0||!E);if(this.last.compare(F)==0){throw new Error("Same occurrence found twice, protecting you from death by recursion")}if(this.rule.until&&this.last.compare(this.rule.until)>0){this.completed=true;return null}else{this.occurrence_number++;return this.last}},next_second:function o(){return this.next_generic("BYSECOND","SECONDLY","second","minute")},increment_second:function j(E){return this.increment_generic(E,"second",60,"minute")},next_minute:function c(){return this.next_generic("BYMINUTE","MINUTELY","minute","hour","next_second")},increment_minute:function A(E){return this.increment_generic(E,"minute",60,"hour")},next_hour:function x(){return this.next_generic("BYHOUR","HOURLY","hour","monthday","next_minute")},increment_hour:function n(E){this.increment_generic(E,"hour",24,"monthday")},next_day:function i(){var F=("BYDAY" in this.by_data);var E=(this.rule.freq=="DAILY");if(this.next_hour()==0){return 0}if(E){this.increment_monthday(this.rule.interval)}else{this.increment_monthday(1)}return 0},next_week:function h(){var F=0;if(this.next_weekday_by_week()==0){return F}if(this.has_by_data("BYWEEKNO")){var E=++this.by_indices.BYWEEKNO;if(this.by_indices.BYWEEKNO==this.by_data.BYWEEKNO.length){this.by_indices.BYWEEKNO=0;F=1}this.last.month=1;this.last.day=1;var G=this.by_data.BYWEEKNO[this.by_indices.BYWEEKNO];this.last.day+=7*G;if(F){this.increment_year(1)}}else{this.increment_monthday(7*this.rule.interval)}return F},normalizeByMonthDayRules:function(G,I,K){var F=ICAL.Time.daysInMonth(I,G);var L=[];var J=0;var E=K.length;var H;for(;J<E;J++){H=K[J];if(Math.abs(H)>F){continue}if(H<0){H=F+(H+1)}else{if(H===0){continue}}if(L.indexOf(H)===-1){L.push(H)}}return L.sort(function(N,M){return N-M})},_byDayAndMonthDay:function(T){var G;var M=this.by_data.BYDAY;var V;var K=0;var Q;var H=M.length;var L=0;var F;var O=this;var I=this.last.day;function P(){F=ICAL.Time.daysInMonth(O.last.month,O.last.year);G=O.normalizeByMonthDayRules(O.last.year,O.last.month,O.by_data.BYMONTHDAY);Q=G.length;while(G[K]<=I&&!(T&&G[K]==I)&&K<Q-1){K++}}function E(){I=0;O.increment_month();K=0;P()}P();if(T){I-=1}var U=48;while(!L&&U){U--;V=I+1;if(V>F){E();continue}var R=G[K++];if(R>=V){I=R}else{E();continue}for(var W=0;W<H;W++){var S=this.ruleDayOfWeek(M[W]);var J=S[0];var N=S[1];this.last.day=I;if(this.last.isNthWeekDay(N,J)){L=1;break}}if(!L&&K===Q){E();continue}}if(U<=0){throw new Error("Malformed values in BYDAY combined with BYMONTHDAY parts")}return L},next_month:function b(){var J=(this.rule.freq=="MONTHLY");var I=1;if(this.next_hour()==0){return I}if(this.has_by_data("BYDAY")&&this.has_by_data("BYMONTHDAY")){I=this._byDayAndMonthDay()}else{if(this.has_by_data("BYDAY")){var H=ICAL.Time.daysInMonth(this.last.month,this.last.year);var F=0;var E=0;if(this.has_by_data("BYSETPOS")){var K=this.last.day;for(var G=1;G<=H;G++){this.last.day=G;if(this.is_day_in_byday(this.last)){E++;if(G<=K){F++}}}this.last.day=K}I=0;for(var G=this.last.day+1;G<=H;G++){this.last.day=G;if(this.is_day_in_byday(this.last)){if(!this.has_by_data("BYSETPOS")||this.check_set_position(++F)||this.check_set_position(F-E-1)){I=1;break}}}if(G>H){this.last.day=1;this.increment_month();if(this.is_day_in_byday(this.last)){if(!this.has_by_data("BYSETPOS")||this.check_set_position(1)){I=1}}else{I=0}}}else{if(this.has_by_data("BYMONTHDAY")){this.by_indices.BYMONTHDAY++;if(this.by_indices.BYMONTHDAY>=this.by_data.BYMONTHDAY.length){this.by_indices.BYMONTHDAY=0;this.increment_month()}var H=ICAL.Time.daysInMonth(this.last.month,this.last.year);var G=this.by_data.BYMONTHDAY[this.by_indices.BYMONTHDAY];if(G<0){G=H+G+1}if(G>H){this.last.day=1;I=this.is_day_in_byday(this.last)}else{this.last.day=G}}else{this.increment_month();var H=ICAL.Time.daysInMonth(this.last.month,this.last.year);if(this.by_data.BYMONTHDAY[0]>H){I=0}else{this.last.day=this.by_data.BYMONTHDAY[0]}}}}return I},next_weekday_by_week:function k(){var F=0;if(this.next_hour()==0){return F}if(!this.has_by_data("BYDAY")){return 1}for(;;){var H=new ICAL.Time();this.by_indices.BYDAY++;if(this.by_indices.BYDAY==Object.keys(this.by_data.BYDAY).length){this.by_indices.BYDAY=0;F=1}var I=this.by_data.BYDAY[this.by_indices.BYDAY];var J=this.ruleDayOfWeek(I);var K=J[1];K-=this.rule.wkst;if(K<0){K+=7}H.year=this.last.year;H.month=this.last.month;H.day=this.last.day;var E=H.startDoyWeek(this.rule.wkst);if(K+E<1){if(!F){continue}}var G=ICAL.Time.fromDayOfYear(E+K,this.last.year);this.last.year=G.year;this.last.month=G.month;this.last.day=G.day;return F}},next_year:function C(){if(this.next_hour()==0){return 0}if(++this.days_index==this.days.length){this.days_index=0;do{this.increment_year(this.rule.interval);this.expand_year_days(this.last.year)}while(this.days.length==0)}this._nextByYearDay();return 1},_nextByYearDay:function f(){var G=this.days[this.days_index];var F=this.last.year;if(G<1){G+=1;F+=1}var E=ICAL.Time.fromDayOfYear(G,F);this.last.day=E.day;this.last.month=E.month},ruleDayOfWeek:function t(G){var E=G.match(/([+-]?[0-9])?(MO|TU|WE|TH|FR|SA|SU)/);if(E){var F=parseInt(E[1]||0,10);G=ICAL.Recur.icalDayToNumericDay(E[2]);return[F,G]}else{return[0,0]}},next_generic:function D(E,L,H,M,I){var F=(E in this.by_data);var J=(this.rule.freq==L);var K=0;if(I&&this[I]()==0){return K}if(F){this.by_indices[E]++;var N=this.by_indices[E];var G=this.by_data[E];if(this.by_indices[E]==G.length){this.by_indices[E]=0;K=1}this.last[H]=G[this.by_indices[E]]}else{if(J){this["increment_"+H](this.rule.interval)}}if(F&&K&&J){this["increment_"+M](1)}return K},increment_monthday:function y(G){for(var F=0;F<G;F++){var E=ICAL.Time.daysInMonth(this.last.month,this.last.year);this.last.day++;if(this.last.day>E){this.last.day-=E;this.increment_month()}}},increment_month:function r(){this.last.day=1;if(this.has_by_data("BYMONTH")){this.by_indices.BYMONTH++;if(this.by_indices.BYMONTH==this.by_data.BYMONTH.length){this.by_indices.BYMONTH=0;this.increment_year(1)}this.last.month=this.by_data.BYMONTH[this.by_indices.BYMONTH]}else{if(this.rule.freq=="MONTHLY"){this.last.month+=this.rule.interval}else{this.last.month++}this.last.month--;var E=ICAL.helpers.trunc(this.last.month/12);this.last.month%=12;this.last.month++;if(E!=0){this.increment_year(E)}}},increment_year:function s(E){this.last.year+=E},increment_generic:function a(I,E,G,F){this.last[E]+=I;var H=ICAL.helpers.trunc(this.last[E]/G);this.last[E]%=G;if(H!=0){this["increment_"+F](H)}},has_by_data:function e(E){return(E in this.rule.parts)},expand_year_days:function d(T){var ag=new ICAL.Time();this.days=[];var am={};var K=["BYDAY","BYWEEKNO","BYMONTHDAY","BYMONTH","BYYEARDAY"];for(var aj in K){if(K.hasOwnProperty(aj)){var O=K[aj];if(O in this.rule.parts){am[O]=this.rule.parts[O]}}}if("BYMONTH" in am&&"BYWEEKNO" in am){var ae=1;var ar={};ag.year=T;ag.isDate=true;for(var L=0;L<this.by_data.BYMONTH.length;L++){var F=this.by_data.BYMONTH[L];ag.month=F;ag.day=1;var G=ag.weekNumber(this.rule.wkst);ag.day=ICAL.Time.daysInMonth(F,T);var ak=ag.weekNumber(this.rule.wkst);for(L=G;L<ak;L++){ar[L]=1}}for(var R=0;R<this.by_data.BYWEEKNO.length&&ae;R++){var ah=this.by_data.BYWEEKNO[R];if(ah<52){ae&=ar[R]}else{ae=0}}if(ae){delete am.BYMONTH}else{delete am.BYWEEKNO}}var E=Object.keys(am).length;if(E==0){var ab=this.dtstart.clone();ab.year=this.last.year;this.days.push(ab.dayOfYear())}else{if(E==1&&"BYMONTH" in am){for(var al in this.by_data.BYMONTH){if(!this.by_data.BYMONTH.hasOwnProperty(al)){continue}var aa=this.dtstart.clone();aa.year=T;aa.month=this.by_data.BYMONTH[al];aa.isDate=true;this.days.push(aa.dayOfYear())}}else{if(E==1&&"BYMONTHDAY" in am){for(var aq in this.by_data.BYMONTHDAY){if(!this.by_data.BYMONTHDAY.hasOwnProperty(aq)){continue}var Z=this.dtstart.clone();var P=this.by_data.BYMONTHDAY[aq];if(P<0){var J=ICAL.Time.daysInMonth(Z.month,T);P=P+J+1}Z.day=P;Z.year=T;Z.isDate=true;this.days.push(Z.dayOfYear())}}else{if(E==2&&"BYMONTHDAY" in am&&"BYMONTH" in am){for(var al in this.by_data.BYMONTH){if(!this.by_data.BYMONTH.hasOwnProperty(al)){continue}var ac=this.by_data.BYMONTH[al];var J=ICAL.Time.daysInMonth(ac,T);for(var aq in this.by_data.BYMONTHDAY){if(!this.by_data.BYMONTHDAY.hasOwnProperty(aq)){continue}var P=this.by_data.BYMONTHDAY[aq];if(P<0){P=P+J+1}ag.day=P;ag.month=ac;ag.year=T;ag.isDate=true;this.days.push(ag.dayOfYear())}}}else{if(E==1&&"BYWEEKNO" in am){}else{if(E==2&&"BYWEEKNO" in am&&"BYMONTHDAY" in am){}else{if(E==1&&"BYDAY" in am){this.days=this.days.concat(this.expand_by_day(T))}else{if(E==2&&"BYDAY" in am&&"BYMONTH" in am){for(var al in this.by_data.BYMONTH){if(!this.by_data.BYMONTH.hasOwnProperty(al)){continue}var F=this.by_data.BYMONTH[al];var J=ICAL.Time.daysInMonth(F,T);ag.year=T;ag.month=this.by_data.BYMONTH[al];ag.day=1;ag.isDate=true;var X=ag.dayOfWeek();var W=ag.dayOfYear()-1;ag.day=J;var M=ag.dayOfWeek();if(this.has_by_data("BYSETPOS")){var ap=0;var ad=[];for(var V=1;V<=J;V++){ag.day=V;if(this.is_day_in_byday(ag)){ad.push(V)}}for(var U=0;U<ad.length;U++){if(this.check_set_position(U+1)||this.check_set_position(U-ad.length)){this.days.push(W+ad[U])}}}else{for(var ai in this.by_data.BYDAY){if(!this.by_data.BYDAY.hasOwnProperty(ai)){continue}var S=this.by_data.BYDAY[ai];var H=this.ruleDayOfWeek(S);var Y=H[0];var ao=H[1];var N;var Q=((ao+7-X)%7)+1;var af=J-((M+7-ao)%7);if(Y==0){for(var V=Q;V<=J;V+=7){this.days.push(W+V)}}else{if(Y>0){N=Q+(Y-1)*7;if(N<=J){this.days.push(W+N)}}else{N=af+(Y+1)*7;if(N>0){this.days.push(W+N)}}}}}}this.days.sort(function(av,au){return av-au})}else{if(E==2&&"BYDAY" in am&&"BYMONTHDAY" in am){var at=this.expand_by_day(T);for(var I in at){if(!at.hasOwnProperty(I)){continue}var V=at[I];var an=ICAL.Time.fromDayOfYear(V,T);if(this.by_data.BYMONTHDAY.indexOf(an.day)>=0){this.days.push(V)}}}else{if(E==3&&"BYDAY" in am&&"BYMONTHDAY" in am&&"BYMONTH" in am){var at=this.expand_by_day(T);for(var I in at){if(!at.hasOwnProperty(I)){continue}var V=at[I];var an=ICAL.Time.fromDayOfYear(V,T);if(this.by_data.BYMONTH.indexOf(an.month)>=0&&this.by_data.BYMONTHDAY.indexOf(an.day)>=0){this.days.push(V)}}}else{if(E==2&&"BYDAY" in am&&"BYWEEKNO" in am){var at=this.expand_by_day(T);for(var I in at){if(!at.hasOwnProperty(I)){continue}var V=at[I];var an=ICAL.Time.fromDayOfYear(V,T);var ah=an.weekNumber(this.rule.wkst);if(this.by_data.BYWEEKNO.indexOf(ah)){this.days.push(V)}}}else{if(E==3&&"BYDAY" in am&&"BYWEEKNO" in am&&"BYMONTHDAY" in am){}else{if(E==1&&"BYYEARDAY" in am){this.days=this.days.concat(this.by_data.BYYEARDAY)}else{this.days=[]}}}}}}}}}}}}}return 0},expand_by_day:function z(L){var G=[];var I=this.last.clone();I.year=L;I.month=1;I.day=1;I.isDate=true;var P=I.dayOfWeek();I.month=12;I.day=31;I.isDate=true;var E=I.dayOfWeek();var N=I.dayOfYear();for(var K in this.by_data.BYDAY){if(!this.by_data.BYDAY.hasOwnProperty(K)){continue}var O=this.by_data.BYDAY[K];var H=this.ruleDayOfWeek(O);var M=H[0];var S=H[1];if(M==0){var F=((S+7-P)%7)+1;for(var R=F;R<=N;R+=7){G.push(R)}}else{if(M>0){var J;if(S>=P){J=S-P+1}else{J=S-P+8}G.push(J+(M-1)*7)}else{var Q;M=-M;if(S<=E){Q=N-E+S}else{Q=N-E+S-7}G.push(Q-(M-1)*7)}}}return G},is_day_in_byday:function q(H){for(var G in this.by_data.BYDAY){if(!this.by_data.BYDAY.hasOwnProperty(G)){continue}var F=this.by_data.BYDAY[G];var I=this.ruleDayOfWeek(F);var K=I[0];var J=I[1];var E=H.dayOfWeek();if((K==0&&J==E)||(H.nthWeekDay(J,K)==H.day)){return 1}}return 0},check_set_position:function B(F){if(this.has_by_data("BYSETPOS")){var E=this.by_data.BYSETPOS.indexOf(F);return E!==-1}return false},sort_byday_rules:function m(K,G){for(var J=0;J<K.length;J++){for(var F=0;F<J;F++){var I=this.ruleDayOfWeek(K[F])[1];var E=this.ruleDayOfWeek(K[J])[1];I-=G;E-=G;if(I<0){I+=7}if(E<0){E+=7}if(I>E){var H=K[J];K[J]=K[F];K[F]=H}}}},check_contract_restriction:function p(K,G){var F=v._indexMap[K];var H=v._expandMap[this.rule.freq][F];var I=false;if(K in this.by_data&&H==v.CONTRACT){var J=this.by_data[K];for(var E in J){if(J.hasOwnProperty(E)){if(J[E]==G){I=true;break}}}}else{I=true}return I},check_contracting_rules:function g(){var G=this.last.dayOfWeek();var E=this.last.weekNumber(this.rule.wkst);var F=this.last.dayOfYear();return(this.check_contract_restriction("BYSECOND",this.last.second)&&this.check_contract_restriction("BYMINUTE",this.last.minute)&&this.check_contract_restriction("BYHOUR",this.last.hour)&&this.check_contract_restriction("BYDAY",ICAL.Recur.numericDayToIcalDay(G))&&this.check_contract_restriction("BYWEEKNO",E)&&this.check_contract_restriction("BYMONTHDAY",this.last.day)&&this.check_contract_restriction("BYMONTH",this.last.month)&&this.check_contract_restriction("BYYEARDAY",F))},setup_defaults:function l(I,H,E){var F=v._indexMap[I];var G=v._expandMap[this.rule.freq][F];if(G!=v.CONTRACT){if(!(I in this.by_data)){this.by_data[I]=[E]}if(this.rule.freq!=H){return this.by_data[I][0]}}return E},toJSON:function(){var E=Object.create(null);E.initialized=this.initialized;E.rule=this.rule.toJSON();E.dtstart=this.dtstart.toJSON();E.by_data=this.by_data;E.days=this.days;E.last=this.last.toJSON();E.by_indices=this.by_indices;E.occurrence_number=this.occurrence_number;return E}};v._indexMap={BYSECOND:0,BYMINUTE:1,BYHOUR:2,BYDAY:3,BYMONTHDAY:4,BYYEARDAY:5,BYWEEKNO:6,BYMONTH:7,BYSETPOS:8};v._expandMap={SECONDLY:[1,1,1,1,1,1,1,1],MINUTELY:[2,1,1,1,1,1,1,1],HOURLY:[2,2,1,1,1,1,1,1],DAILY:[2,2,2,1,1,1,1,1],WEEKLY:[2,2,2,2,3,3,1,1],MONTHLY:[2,2,2,2,2,3,3,1],YEARLY:[2,2,2,2,2,2,2,2]};v.UNKNOWN=0;v.CONTRACT=1;v.EXPAND=2;v.ILLEGAL=3;return v}());ICAL.RecurExpansion=(function(){function d(e){return ICAL.helpers.formatClassType(e,ICAL.Time)}function c(f,e){return f.compare(e)}function a(e){return e.hasProperty("rdate")||e.hasProperty("rrule")||e.hasProperty("recurrence-id")}function b(e){this.ruleDates=[];this.exDates=[];this.fromData(e)}b.prototype={complete:false,ruleIterators:null,ruleDates:null,exDates:null,ruleDateInc:0,exDateInc:0,exDate:null,ruleDate:null,dtstart:null,last:null,fromData:function(e){var f=ICAL.helpers.formatClassType(e.dtstart,ICAL.Time);if(!f){throw new Error(".dtstart (ICAL.Time) must be given")}else{this.dtstart=f}if(e.component){this._init(e.component)}else{this.last=d(e.last)||f.clone();if(!e.ruleIterators){throw new Error(".ruleIterators or .component must be given")}this.ruleIterators=e.ruleIterators.map(function(g){return ICAL.helpers.formatClassType(g,ICAL.RecurIterator)});this.ruleDateInc=e.ruleDateInc;this.exDateInc=e.exDateInc;if(e.ruleDates){this.ruleDates=e.ruleDates.map(d);this.ruleDate=this.ruleDates[this.ruleDateInc]}if(e.exDates){this.exDates=e.exDates.map(d);this.exDate=this.exDates[this.exDateInc]}if(typeof(e.complete)!=="undefined"){this.complete=e.complete}}},next:function(){var e;var h;var f;var g;var j=500;var i=0;while(true){if(i++>j){throw new Error("max tries have occured, rule may be impossible to forfill.")}f=this.ruleDate;e=this._nextRecurrenceIter(this.last);if(!f&&!e){this.complete=true;break}if(!f||(e&&f.compare(e.last)>0)){f=e.last.clone();e.next()}if(this.ruleDate===f){this._nextRuleDay()}this.last=f;if(this.exDate){g=this.exDate.compare(this.last);if(g<0){this._nextExDay()}if(g===0){this._nextExDay();continue}}return this.last}},toJSON:function(){function f(g){return g.toJSON()}var e=Object.create(null);e.ruleIterators=this.ruleIterators.map(f);if(this.ruleDates){e.ruleDates=this.ruleDates.map(f)}if(this.exDates){e.exDates=this.exDates.map(f)}e.ruleDateInc=this.ruleDateInc;e.exDateInc=this.exDateInc;e.last=this.last.toJSON();e.dtstart=this.dtstart.toJSON();e.complete=this.complete;return e},_extractDates:function(k,g){function m(i){l=ICAL.helpers.binsearchInsert(n,i,c);n.splice(l,0,i)}var n=[];var j=k.getAllProperties(g);var h=j.length;var f=0;var e;var l;for(;f<h;f++){j[f].getValues().forEach(m)}return n},_init:function(g){this.ruleIterators=[];this.last=this.dtstart.clone();if(!a(g)){this.ruleDate=this.last.clone();this.complete=true;return}if(g.hasProperty("rdate")){this.ruleDates=this._extractDates(g,"rdate");if((this.ruleDates[0])&&(this.ruleDates[0].compare(this.dtstart)<0)){this.ruleDateInc=0;this.last=this.ruleDates[0].clone()}else{this.ruleDateInc=ICAL.helpers.binsearchInsert(this.ruleDates,this.last,c)}this.ruleDate=this.ruleDates[this.ruleDateInc]}if(g.hasProperty("rrule")){var k=g.getAllProperties("rrule");var h=0;var e=k.length;var j;var f;for(;h<e;h++){j=k[h].getFirstValue();f=j.iterator(this.dtstart);this.ruleIterators.push(f);f.next()}}if(g.hasProperty("exdate")){this.exDates=this._extractDates(g,"exdate");this.exDateInc=ICAL.helpers.binsearchInsert(this.exDates,this.last,c);this.exDate=this.exDates[this.exDateInc]}},_nextExDay:function(){this.exDate=this.exDates[++this.exDateInc]},_nextRuleDay:function(){this.ruleDate=this.ruleDates[++this.ruleDateInc]},_nextRecurrenceIter:function(){var g=this.ruleIterators;if(g.length===0){return null}var e=g.length;var f;var j;var h=0;var i;for(;h<e;h++){f=g[h];j=f.last;if(f.completed){e--;if(h!==0){h--}g.splice(h,1);continue}if(!i||i.last.compare(j)>0){i=f}}return i}};return b}());ICAL.Event=(function(){function a(d,c){if(!(d instanceof ICAL.Component)){c=d;d=null}if(d){this.component=d}else{this.component=new ICAL.Component("vevent")}this._rangeExceptionCache=Object.create(null);this.exceptions=Object.create(null);this.rangeExceptions=[];if(c&&c.strictExceptions){this.strictExceptions=c.strictExceptions}if(c&&c.exceptions){c.exceptions.forEach(this.relateException,this)}else{if(this.component.parent&&!this.isRecurrenceException()){this.component.parent.getAllSubcomponents("vevent").forEach(function(e){if(e.hasProperty("recurrence-id")){this.relateException(e)}},this)}}}a.prototype={THISANDFUTURE:"THISANDFUTURE",exceptions:null,strictExceptions:false,relateException:function(e){if(this.isRecurrenceException()){throw new Error("cannot relate exception to exceptions")}if(e instanceof ICAL.Component){e=new ICAL.Event(e)}if(this.strictExceptions&&e.uid!==this.uid){throw new Error("attempted to relate unrelated exception")}var f=e.recurrenceId.toString();this.exceptions[f]=e;if(e.modifiesFuture()){var d=[e.recurrenceId.toUnixTime(),f];var c=ICAL.helpers.binsearchInsert(this.rangeExceptions,d,b);this.rangeExceptions.splice(c,0,d)}},modifiesFuture:function(){if(!this.component.hasProperty("recurrence-id")){return false}var c=this.component.getFirstProperty("recurrence-id").getParameter("range");return c===this.THISANDFUTURE},findRangeException:function(f){if(!this.rangeExceptions.length){return null}var e=f.toUnixTime();var d=ICAL.helpers.binsearchInsert(this.rangeExceptions,[e],b);d-=1;if(d<0){return null}var c=this.rangeExceptions[d];if(e<c[0]){return null}return c[1]},getOccurrenceDetails:function(l){var e=l.toString();var h=l.convertToZone(ICAL.Timezone.utcTimezone).toString();var m;var n={recurrenceId:l};if(e in this.exceptions){m=n.item=this.exceptions[e];n.startDate=m.startDate;n.endDate=m.endDate;n.item=m}else{if(h in this.exceptions){m=this.exceptions[h];n.startDate=m.startDate;n.endDate=m.endDate;n.item=m}else{var c=this.findRangeException(l);var i;if(c){var g=this.exceptions[c];n.item=g;var k=this._rangeExceptionCache[c];if(!k){var f=g.recurrenceId.clone();var j=g.startDate.clone();f.zone=j.zone;k=j.subtractDate(f);this._rangeExceptionCache[c]=k}var d=l.clone();d.zone=g.startDate.zone;d.addDuration(k);i=d.clone();i.addDuration(g.duration);n.startDate=d;n.endDate=i}else{i=l.clone();i.addDuration(this.duration);n.endDate=i;n.startDate=l;n.item=this}}}return n},iterator:function(c){return new ICAL.RecurExpansion({component:this.component,dtstart:c||this.startDate})},isRecurring:function(){var c=this.component;return c.hasProperty("rrule")||c.hasProperty("rdate")},isRecurrenceException:function(){return this.component.hasProperty("recurrence-id")},getRecurrenceTypes:function(){var g=this.component.getAllProperties("rrule");var e=0;var d=g.length;var c=Object.create(null);for(;e<d;e++){var f=g[e].getFirstValue();c[f.freq]=true}return c},get uid(){return this._firstProp("uid")},set uid(c){this._setProp("uid",c)},get startDate(){return this._firstProp("dtstart")},set startDate(c){this._setTime("dtstart",c)},get endDate(){var d=this._firstProp("dtend");if(!d){var c=this._firstProp("duration");d=this.startDate.clone();if(c){d.addDuration(c)}else{if(d.isDate){d.day+=1}}}return d},set endDate(c){if(this.component.hasProperty("duration")){this.component.removeProperty("duration")}this._setTime("dtend",c)},get duration(){var c=this._firstProp("duration");if(!c){return this.endDate.subtractDate(this.startDate)}return c},set duration(c){if(this.component.hasProperty("dtend")){this.component.removeProperty("dtend")}this._setProp("duration",c)},get location(){return this._firstProp("location")},set location(c){return this._setProp("location",c)},get attendees(){return this.component.getAllProperties("attendee")},get summary(){return this._firstProp("summary")},set summary(c){this._setProp("summary",c)},get description(){return this._firstProp("description")},set description(c){this._setProp("description",c)},get organizer(){return this._firstProp("organizer")},set organizer(c){this._setProp("organizer",c)},get sequence(){return this._firstProp("sequence")},set sequence(c){this._setProp("sequence",c)},get recurrenceId(){return this._firstProp("recurrence-id")},set recurrenceId(c){this._setProp("recurrence-id",c)},_setTime:function(c,d){var e=this.component.getFirstProperty(c);if(!e){e=new ICAL.Property(c);this.component.addProperty(e)}if(d.zone===ICAL.Timezone.localTimezone||d.zone===ICAL.Timezone.utcTimezone){e.removeParameter("tzid")}else{e.setParameter("tzid",d.zone.tzid)}e.setValue(d)},_setProp:function(c,d){this.component.updatePropertyWithValue(c,d)},_firstProp:function(c){return this.component.getFirstPropertyValue(c)},toString:function(){return this.component.toString()}};function b(d,c){if(d[0]>c[0]){return 1}if(c[0]>d[0]){return -1}return 0}return a}());ICAL.ComponentParser=(function(){function a(b){if(typeof(b)==="undefined"){b={}}var c;for(c in b){if(b.hasOwnProperty(c)){this[c]=b[c]}}}a.prototype={parseEvent:true,parseTimezone:true,oncomplete:function(){},onerror:function(b){},ontimezone:function(b){},onevent:function(b){},process:function(c){if(typeof(c)==="string"){c=ICAL.parse(c)}if(!(c instanceof ICAL.Component)){c=new ICAL.Component(c)}var f=c.getAllSubcomponents();var e=0;var b=f.length;var d;for(;e<b;e++){d=f[e];switch(d.name){case"vtimezone":if(this.parseTimezone){var g=d.getFirstPropertyValue("tzid");if(g){this.ontimezone(new ICAL.Timezone({tzid:g,component:d}))}}break;case"vevent":if(this.parseEvent){this.onevent(new ICAL.Event(d))}break;default:continue}}this.oncomplete()}};return a}());